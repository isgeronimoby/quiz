window.addEventListener("load",function(){var e=function(){if(document.getElementById("dgl-gamified-widget")){var e=document.getElementById("dgl-gamified-widget"),t=e.src;t=t.substring(t.lastIndexOf("/")+1,0);var n,a,i=e.getAttribute("data-key"),r=!1,o="club";if(i)return null!==e.getAttribute("data-tunnel")?(a="http://spr-api-test.cloudapp.net/core/v1/xdm/tunnel",n=a.substring(a.lastIndexOf("/xdm/")+1,0),"local"===e.getAttribute("data-tunnel")?(a="http://localhostdev/spr-api/core/v1/xdm/tunnel",n=a.substring(a.lastIndexOf("/xdm/")+1,0)):"live"===e.getAttribute("data-tunnel")&&(a="https://api.rewarded.club/core/v1/xdm/tunnel",n=a.substring(a.lastIndexOf("/xdm/")+1,0))):(a="https://api.rewarded.club/core/v1/xdm/tunnel",n=a.substring(a.lastIndexOf("/xdm/")+1,0)),null!==e.getAttribute("data-debug")&&(r="false"!==e.getAttribute("data-debug")),null!==e.getAttribute("data-type")&&""!==e.getAttribute("data-type")&&(o=e.getAttribute("data-type")),{templates:{side:{}},main:{methods:{},elements:{pages:{}},currentState:"",cache:{drawsList:[],drawsEntries:[],rewardedActions:[],userRelations:{}},shown:!1,settings:{draws:{showExpired:!0,currentSubMenu:"dg-o-w-show-all-draws"},friends:{currentSubMenu:"friends"}}},side:{methods:{},elements:{}},global:{type:o,club:{name:"TEST_CLUB"},authorized:!1,launched:!1,safariFix:!1,activeDrawsExist:!1,offers:{requests:{}},actions:{requests:{}},api:{apiKey:i,requests:{}},cache:{last:{}},elements:{},methods:{},tunnelPath:a,envPath:n,widgetPathName:t,userStats:{},debug:r,gaSend:"",safariFixFirstOpen:!1},states:{},helpers:{}}}console.warn("No script ID or data-key attribute provided")}();if(e){!function(e,t,n,a,i,r){function o(e,t){var n=typeof e[t];return"function"==n||!("object"!=n||!e[t])||"unknown"==n}function s(e,t){return!("object"!=typeof e[t]||!e[t])}function l(e){return"[object Array]"===Object.prototype.toString.call(e)}function d(){var e="Shockwave Flash",t="application/x-shockwave-flash";if(!b(navigator.plugins)&&"object"==typeof navigator.plugins[e]){var n=navigator.plugins[e].description;n&&!b(navigator.mimeTypes)&&navigator.mimeTypes[t]&&navigator.mimeTypes[t].enabledPlugin&&(L=n.match(/\d+/g))}if(!L){var a;try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),L=Array.prototype.slice.call(a.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),a=null}catch(i){}}if(!L)return!1;var r=parseInt(L[0],10),o=parseInt(L[1],10);return A=r>9&&o>0,!0}function c(){if(!G){G=!0;for(var e=0;e<j.length;e++)j[e]();j.length=0}}function u(e,t){return G?void e.call(t):void j.push(function(){e.call(t)})}function g(){var e=parent;if(""!==x)for(var t=0,n=x.split(".");t<n.length;t++)e=e[n[t]];return e.easyXDM}function m(t){return e.easyXDM=B,x=t,x&&(W="easyXDM_"+x.replace(".","_")+"_"),U}function p(e){return e.match(I)[3]}function f(e){return e.match(I)[4]||""}function h(e){var t=e.toLowerCase().match(I),n=t[2],a=t[3],i=t[4]||"";return("http:"==n&&":80"==i||"https:"==n&&":443"==i)&&(i=""),n+"//"+a+i}function w(e){if(e=e.replace(R,"$1/"),!e.match(/^(http||https):\/\//)){var t="/"===e.substring(0,1)?"":n.pathname;"/"!==t.substring(t.length-1)&&(t=t.substring(0,t.lastIndexOf("/")+1)),e=n.protocol+"//"+n.host+t+e}for(;N.test(e);)e=e.replace(N,"");return e}function v(e,t){var n="",a=e.indexOf("#");-1!==a&&(n=e.substring(a),e=e.substring(0,a));var i=[];for(var o in t)t.hasOwnProperty(o)&&i.push(o+"="+r(t[o]));return e+(z?"#":-1==e.indexOf("?")?"?":"&")+i.join("&")+n}function b(e){return"undefined"==typeof e}function y(e,t,n){var a;for(var i in t)t.hasOwnProperty(i)&&(i in e?(a=t[i],"object"==typeof a?y(e[i],a,n):n||(e[i]=t[i])):e[i]=t[i]);return e}function S(){var e=t.body.appendChild(t.createElement("form")),n=e.appendChild(t.createElement("input"));n.name=W+"TEST"+O,M=n!==e.elements[n.name],t.body.removeChild(e)}function k(e){b(M)&&S();var n;M?n=t.createElement('<iframe name="'+e.props.name+'"/>'):(n=t.createElement("IFRAME"),n.name=e.props.name),n.id=n.name=e.props.name,delete e.props.name,"string"==typeof e.container&&(e.container=t.getElementById(e.container)),e.container||(y(n.style,{position:"absolute",top:"-2000px",left:"0px"}),e.container=t.body);var a=e.props.src;if(e.props.src="javascript:false",y(n,e.props),n.border=n.frameBorder=0,n.allowTransparency=!0,e.container.appendChild(n),e.onLoad&&D(n,"load",e.onLoad),e.usePost){var i,r=e.container.appendChild(t.createElement("form"));if(r.target=n.name,r.action=a,r.method="POST","object"==typeof e.usePost)for(var o in e.usePost)e.usePost.hasOwnProperty(o)&&(M?i=t.createElement('<input name="'+o+'"/>'):(i=t.createElement("INPUT"),i.name=o),i.value=e.usePost[o],r.appendChild(i));r.submit(),r.parentNode.removeChild(r)}else n.src=a;return e.props.src=a,n}function C(e,t){"string"==typeof e&&(e=[e]);for(var n,a=e.length;a--;)if(n=e[a],n=new RegExp("^"==n.substr(0,1)?n:"^"+n.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),n.test(t))return!0;return!1}function q(a){var i,r=a.protocol;if(a.isHost=a.isHost||b(V.xdm_p),z=a.hash||!1,a.props||(a.props={}),a.isHost)a.remote=w(a.remote),a.channel=a.channel||"default"+O++,a.secret=Math.random().toString(16).substring(2),b(r)&&(r=h(n.href)==h(a.remote)?"4":o(e,"postMessage")||o(t,"postMessage")?"1":a.swf&&o(e,"ActiveXObject")&&d()?"6":"Gecko"===navigator.product&&"frameElement"in e&&-1==navigator.userAgent.indexOf("WebKit")?"5":a.remoteHelper?"2":"0");else if(a.channel=V.xdm_c.replace(/["'<>\\]/g,""),a.secret=V.xdm_s,a.remote=V.xdm_e.replace(/["'<>\\]/g,""),r=V.xdm_p,a.acl&&!C(a.acl,a.remote))throw new Error("Access denied for "+a.remote);switch(a.protocol=r,r){case"0":if(y(a,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0),a.isHost){if(!a.local){for(var s,l=n.protocol+"//"+n.host,c=t.body.getElementsByTagName("img"),u=c.length;u--;)if(s=c[u],s.src.substring(0,l.length)===l){a.local=s.src;break}a.local||(a.local=e)}var g={xdm_c:a.channel,xdm_p:0};a.local===e?(a.usePolling=!0,a.useParent=!0,a.local=n.protocol+"//"+n.host+n.pathname+n.search,g.xdm_e=a.local,g.xdm_pa=1):g.xdm_e=w(a.local),a.container&&(a.useResize=!1,g.xdm_po=1),a.remote=v(a.remote,g)}else y(a,{channel:V.xdm_c,remote:V.xdm_e,useParent:!b(V.xdm_pa),usePolling:!b(V.xdm_po),useResize:a.useParent?!1:a.useResize});i=[new U.stack.HashTransport(a),new U.stack.ReliableBehavior({}),new U.stack.QueueBehavior({encode:!0,maxLength:4e3-a.remote.length}),new U.stack.VerifyBehavior({initiate:a.isHost})];break;case"1":i=[new U.stack.PostMessageTransport(a)];break;case"2":a.isHost&&(a.remoteHelper=w(a.remoteHelper)),i=[new U.stack.NameTransport(a),new U.stack.QueueBehavior,new U.stack.VerifyBehavior({initiate:a.isHost})];break;case"3":i=[new U.stack.NixTransport(a)];break;case"4":i=[new U.stack.SameOriginTransport(a)];break;case"5":i=[new U.stack.FrameElementTransport(a)];break;case"6":L||d(),i=[new U.stack.FlashTransport(a)]}return i.push(new U.stack.QueueBehavior({lazy:a.lazy,remove:!0})),i}function E(e){for(var t,n={incoming:function(e,t){this.up.incoming(e,t)},outgoing:function(e,t){this.down.outgoing(e,t)},callback:function(e){this.up.callback(e)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}},a=0,i=e.length;i>a;a++)t=e[a],y(t,n,!0),0!==a&&(t.down=e[a-1]),a!==i-1&&(t.up=e[a+1]);return t}function T(e){e.up.down=e.down,e.down.up=e.up,e.up=e.down=null}var M,L,A,D,P,H=this,O=Math.floor(1e4*Math.random()),F=Function.prototype,I=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,N=/[\-\w]+\/\.\.\//,R=/([^:])\/\//g,x="",U={},B=e.easyXDM,W="easyXDM_",z=!1;if(o(e,"addEventListener"))D=function(e,t,n){e.addEventListener(t,n,!1)},P=function(e,t,n){e.removeEventListener(t,n,!1)};else{if(!o(e,"attachEvent"))throw new Error("Browser not supported");D=function(e,t,n){e.attachEvent("on"+t,n)},P=function(e,t,n){e.detachEvent("on"+t,n)}}var _,G=!1,j=[];if("readyState"in t?(_=t.readyState,G="complete"==_||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==_||"interactive"==_)):G=!!t.body,!G){if(o(e,"addEventListener"))D(t,"DOMContentLoaded",c);else if(D(t,"readystatechange",function(){"complete"==t.readyState&&c()}),t.documentElement.doScroll&&e===top){var J=function(){if(!G){try{t.documentElement.doScroll("left")}catch(e){return void a(J,1)}c()}};J()}D(e,"load",c)}var V=function(e){e=e.substring(1).split("&");for(var t,n={},a=e.length;a--;)t=e[a].split("="),n[t[0]]=i(t[1]);return n}(/xdm_e=/.test(n.search)?n.search:n.hash),Y=function(){var e={},t={a:[1,2,3]},n='{"a":[1,2,3]}';return"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&JSON.stringify(t).replace(/\s/g,"")===n?JSON:(Object.toJSON&&Object.toJSON(t).replace(/\s/g,"")===n&&(e.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(t=n.evalJSON(),t.a&&3===t.a.length&&3===t.a[2]&&(e.parse=function(e){return e.evalJSON()})),e.stringify&&e.parse?(Y=function(){return e},e):null)};y(U,{version:"2.4.19.3",query:V,stack:{},apply:y,getJSONObject:Y,whenReady:u,noConflict:m}),U.DomHelper={on:D,un:P,requiresJSON:function(n){s(e,"JSON")||t.write('<script type="text/javascript" src="'+n+'"></script>')}},function(){var e={};U.Fn={set:function(t,n){e[t]=n},get:function(t,n){if(e.hasOwnProperty(t)){var a=e[t];return n&&delete e[t],a}}}}(),U.Socket=function(e){var t=E(q(e).concat([{incoming:function(t,n){e.onMessage(t,n)},callback:function(t){e.onReady&&e.onReady(t)}}])),n=h(e.remote);this.origin=h(e.remote),this.destroy=function(){t.destroy()},this.postMessage=function(e){t.outgoing(e,n)},t.init()},U.Rpc=function(e,t){if(t.local)for(var n in t.local)if(t.local.hasOwnProperty(n)){var a=t.local[n];"function"==typeof a&&(t.local[n]={method:a})}var i=E(q(e).concat([new U.stack.RpcBehavior(this,t),{callback:function(t){e.onReady&&e.onReady(t)}}]));this.origin=h(e.remote),this.destroy=function(){i.destroy()},i.init()},U.stack.SameOriginTransport=function(e){var t,i,r,o;return t={outgoing:function(e,t,n){r(e),n&&n()},destroy:function(){i&&(i.parentNode.removeChild(i),i=null)},onDOMReady:function(){o=h(e.remote),e.isHost?(y(e.props,{src:v(e.remote,{xdm_e:n.protocol+"//"+n.host+n.pathname,xdm_c:e.channel,xdm_p:4}),name:W+e.channel+"_provider"}),i=k(e),U.Fn.set(e.channel,function(e){return r=e,a(function(){t.up.callback(!0)},0),function(e){t.up.incoming(e,o)}})):(r=g().Fn.get(e.channel,!0)(function(e){t.up.incoming(e,o)}),a(function(){t.up.callback(!0)},0))},init:function(){u(t.onDOMReady,t)}}},U.stack.FlashTransport=function(e){function i(e,t){a(function(){s.up.incoming(e,d)},0)}function o(n){var a=e.swf+"?host="+e.isHost,i="easyXDM_swf_"+Math.floor(1e4*Math.random());U.Fn.set("flash_loaded"+n.replace(/[\-.]/g,"_"),function(){U.stack.FlashTransport[n].swf=c=g.firstChild;for(var e=U.stack.FlashTransport[n].queue,t=0;t<e.length;t++)e[t]();e.length=0}),e.swfContainer?g="string"==typeof e.swfContainer?t.getElementById(e.swfContainer):e.swfContainer:(g=t.createElement("div"),y(g.style,A&&e.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),t.body.appendChild(g));var o="callback=flash_loaded"+r(n.replace(/[\-.]/g,"_"))+"&proto="+H.location.protocol+"&domain="+r(p(H.location.href))+"&port="+r(f(H.location.href))+"&ns="+r(x);g.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+i+"' data='"+a+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+a+"'></param><param name='flashvars' value='"+o+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+o+"' allowScriptAccess='always' wmode='transparent' src='"+a+"' height='1' width='1'></embed></object>"}var s,l,d,c,g;return s={outgoing:function(t,n,a){c.postMessage(e.channel,t.toString()),a&&a()},destroy:function(){try{c.destroyChannel(e.channel)}catch(t){}c=null,l&&(l.parentNode.removeChild(l),l=null)},onDOMReady:function(){d=e.remote,U.Fn.set("flash_"+e.channel+"_init",function(){a(function(){s.up.callback(!0)})}),U.Fn.set("flash_"+e.channel+"_onMessage",i),e.swf=w(e.swf);var t=p(e.swf),r=function(){U.stack.FlashTransport[t].init=!0,c=U.stack.FlashTransport[t].swf,c.createChannel(e.channel,e.secret,h(e.remote),e.isHost),e.isHost&&(A&&e.swfNoThrottle&&y(e.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),y(e.props,{src:v(e.remote,{xdm_e:h(n.href),xdm_c:e.channel,xdm_p:6,xdm_s:e.secret}),name:W+e.channel+"_provider"}),l=k(e))};U.stack.FlashTransport[t]&&U.stack.FlashTransport[t].init?r():U.stack.FlashTransport[t]?U.stack.FlashTransport[t].queue.push(r):(U.stack.FlashTransport[t]={queue:[r]},o(t))},init:function(){u(s.onDOMReady,s)}}},U.stack.PostMessageTransport=function(t){function i(e){if(e.origin)return h(e.origin);if(e.uri)return h(e.uri);if(e.domain)return n.protocol+"//"+e.domain;throw"Unable to retrieve the origin of the event"}function r(e){var n=i(e);n==d&&e.data.substring(0,t.channel.length+1)==t.channel+" "&&o.up.incoming(e.data.substring(t.channel.length+1),n)}var o,s,l,d;return o={outgoing:function(e,n,a){l.postMessage(t.channel+" "+e,n||d),a&&a()},destroy:function(){P(e,"message",r),s&&(l=null,s.parentNode.removeChild(s),s=null)},onDOMReady:function(){if(d=h(t.remote),t.isHost){var i=function(n){n.data==t.channel+"-ready"&&(l="postMessage"in s.contentWindow?s.contentWindow:s.contentWindow.document,P(e,"message",i),D(e,"message",r),a(function(){o.up.callback(!0)},0))};D(e,"message",i),y(t.props,{src:v(t.remote,{xdm_e:h(n.href),xdm_c:t.channel,xdm_p:1}),name:W+t.channel+"_provider"}),s=k(t)}else D(e,"message",r),l="postMessage"in e.parent?e.parent:e.parent.document,l.postMessage(t.channel+"-ready",d),a(function(){o.up.callback(!0)},0)},init:function(){u(o.onDOMReady,o)}}},U.stack.FrameElementTransport=function(i){var r,o,s,l;return r={outgoing:function(e,t,n){s.call(this,e),n&&n()},destroy:function(){o&&(o.parentNode.removeChild(o),o=null)},onDOMReady:function(){l=h(i.remote),i.isHost?(y(i.props,{src:v(i.remote,{xdm_e:h(n.href),xdm_c:i.channel,xdm_p:5}),name:W+i.channel+"_provider"}),o=k(i),o.fn=function(e){return delete o.fn,s=e,a(function(){r.up.callback(!0)},0),function(e){r.up.incoming(e,l)}}):(t.referrer&&h(t.referrer)!=V.xdm_e&&(e.top.location=V.xdm_e),s=e.frameElement.fn(function(e){r.up.incoming(e,l)}),r.up.callback(!0))},init:function(){u(r.onDOMReady,r)}}},U.stack.NameTransport=function(e){function t(t){var n=e.remoteHelper+(s?"#_3":"#_2")+e.channel;l.contentWindow.sendMessage(t,n)}function n(){s?2!==++c&&s||o.up.callback(!0):(t("ready"),o.up.callback(!0))}function i(e){o.up.incoming(e,m)}function r(){g&&a(function(){g(!0)},0)}var o,s,l,d,c,g,m,p;return o={outgoing:function(e,n,a){g=a,t(e)},destroy:function(){l.parentNode.removeChild(l),l=null,s&&(d.parentNode.removeChild(d),d=null)},onDOMReady:function(){s=e.isHost,c=0,m=h(e.remote),e.local=w(e.local),s?(U.Fn.set(e.channel,function(t){s&&"ready"===t&&(U.Fn.set(e.channel,i),n())}),p=v(e.remote,{xdm_e:e.local,xdm_c:e.channel,xdm_p:2}),y(e.props,{src:p+"#"+e.channel,name:W+e.channel+"_provider"}),d=k(e)):(e.remoteHelper=e.remote,U.Fn.set(e.channel,i));var t=function(){var i=l||this;P(i,"load",t),U.Fn.set(e.channel+"_load",r),function o(){"function"==typeof i.contentWindow.sendMessage?n():a(o,50)}()};l=k({props:{src:e.local+"#_4"+e.channel},onLoad:t})},init:function(){u(o.onDOMReady,o)}}},U.stack.HashTransport=function(t){function n(e){if(f){var n=t.remote+"#"+m++ +"_"+e;(l||!w?f.contentWindow:f).location=n}}function i(e){g=e,s.up.incoming(g.substring(g.indexOf("_")+1),v)}function r(){if(p){var e=p.location.href,t="",n=e.indexOf("#");-1!=n&&(t=e.substring(n)),t&&t!=g&&i(t)}}function o(){d=setInterval(r,c)}var s,l,d,c,g,m,p,f,w,v;return s={outgoing:function(e,t){n(e)},destroy:function(){e.clearInterval(d),!l&&w||f.parentNode.removeChild(f),f=null},onDOMReady:function(){if(l=t.isHost,c=t.interval,g="#"+t.channel,m=0,w=t.useParent,v=h(t.remote),l){if(y(t.props,{src:t.remote,name:W+t.channel+"_provider"}),w)t.onLoad=function(){p=e,o(),s.up.callback(!0)};else{var n=0,i=t.delay/50;!function r(){if(++n>i)throw new Error("Unable to reference listenerwindow");try{p=f.contentWindow.frames[W+t.channel+"_consumer"]}catch(e){}p?(o(),s.up.callback(!0)):a(r,50)}()}f=k(t)}else p=e,o(),w?(f=parent,s.up.callback(!0)):(y(t,{props:{src:t.remote+"#"+t.channel+new Date,name:W+t.channel+"_consumer"},onLoad:function(){s.up.callback(!0)}}),f=k(t))},init:function(){u(s.onDOMReady,s)}}},U.stack.ReliableBehavior=function(e){var t,n,a=0,i=0,r="";return t={incoming:function(e,o){var s=e.indexOf("_"),l=e.substring(0,s).split(",");e=e.substring(s+1),l[0]==a&&(r="",n&&n(!0)),e.length>0&&(t.down.outgoing(l[1]+","+a+"_"+r,o),i!=l[1]&&(i=l[1],t.up.incoming(e,o)))},outgoing:function(e,o,s){r=e,n=s,t.down.outgoing(i+","+ ++a+"_"+e,o)}}},U.stack.QueueBehavior=function(e){function t(){if(e.remove&&0===s.length)return void T(n);if(!l&&0!==s.length&&!o){l=!0;var i=s.shift();n.down.outgoing(i.data,i.origin,function(e){l=!1,i.callback&&a(function(){i.callback(e)},0),t()})}}var n,o,s=[],l=!0,d="",c=0,u=!1,g=!1;return n={init:function(){b(e)&&(e={}),e.maxLength&&(c=e.maxLength,g=!0),e.lazy?u=!0:n.down.init()},callback:function(e){l=!1;var a=n.up;t(),a.callback(e)},incoming:function(t,a){if(g){var r=t.indexOf("_"),o=parseInt(t.substring(0,r),10);d+=t.substring(r+1),0===o&&(e.encode&&(d=i(d)),n.up.incoming(d,a),d="")}else n.up.incoming(t,a)},outgoing:function(a,i,o){e.encode&&(a=r(a));var l,d=[];if(g){for(;0!==a.length;)l=a.substring(0,c),a=a.substring(l.length),d.push(l);for(;l=d.shift();)s.push({data:d.length+"_"+l,origin:i,callback:0===d.length?o:null})}else s.push({data:a,origin:i,callback:o});u?n.down.init():t()},destroy:function(){o=!0,n.down.destroy()}}},U.stack.VerifyBehavior=function(e){function t(){a=Math.random().toString(16).substring(2),n.down.outgoing(a)}var n,a,i;return n={incoming:function(r,o){var s=r.indexOf("_");-1===s?r===a?n.up.callback(!0):i||(i=r,e.initiate||t(),n.down.outgoing(r)):r.substring(0,s)===i&&n.up.incoming(r.substring(s+1),o)},outgoing:function(e,t,i){n.down.outgoing(a+"_"+e,t,i)},callback:function(n){e.initiate&&t()}}},U.stack.RpcBehavior=function(e,t){function n(e){e.jsonrpc="2.0",r.down.outgoing(o.stringify(e))}function a(e,t){var a=Array.prototype.slice;return function(){var i,r=arguments.length,o={method:t};r>0&&"function"==typeof arguments[r-1]?(r>1&&"function"==typeof arguments[r-2]?(i={success:arguments[r-2],error:arguments[r-1]},o.params=a.call(arguments,0,r-2)):(i={success:arguments[r-1]},o.params=a.call(arguments,0,r-1)),d[""+ ++s]=i,o.id=s):o.params=a.call(arguments,0),e.namedParams&&1===o.params.length&&(o.params=o.params[0]),n(o)}}function i(e,t,a,i){if(!a)return void(t&&n({id:t,error:{code:-32601,message:"Procedure not found."}}));var r,o;t?(r=function(e){r=F,n({id:t,result:e})},o=function(e,a){o=F;var i={id:t,error:{code:-32099,message:e}};a&&(i.error.data=a),n(i)}):r=o=F,l(i)||(i=[i]);try{var s=a.method.apply(a.scope,i.concat([r,o]));b(s)||r(s)}catch(d){o(d.message)}}var r,o=t.serializer||Y(),s=0,d={};return r={incoming:function(e,a){var r=o.parse(e);if(r.method)t.handle?t.handle(r,n):i(r.method,r.id,t.local[r.method],r.params);else{var s=d[r.id];r.error?s.error&&s.error(r.error):s.success&&s.success(r.result),delete d[r.id]}},init:function(){if(t.remote)for(var n in t.remote)t.remote.hasOwnProperty(n)&&(e[n]=a(t.remote[n],n));r.down.init()},destroy:function(){for(var n in t.remote)t.remote.hasOwnProperty(n)&&e.hasOwnProperty(n)&&delete e[n];r.down.destroy()}}},H.easyXDM=U}(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent),e.global.api.easyXDM=easyXDM.noConflict("DGW.global.api"),e.global.api.rpc=new e.global.api.easyXDM.Rpc({remote:e.global.tunnelPath},{remote:{apiTunnel:{},writeClubCookie:{},readClubCookie:{}}}),e.global.api.generic=function(t,n,a){var i={},r="GET",o="";switch(a=a||"",t){case"getApp":o="app/getapp";break;case"signUp":r="POST",o="auth/signup",a=JSON.stringify(a);break;case"signIn":r="POST",o="auth/login",a=JSON.stringify(a);break;case"signOut":r="POST",o="auth/logout";break;case"forgotPass":r="POST",o="auth/forgotpassword",a=JSON.stringify(a);break;case"getUser":o="user/getuser";break;case"getDraws":o="draw/getdraws";break;case"getDrawEntries":o="draw/getdrawentries";break;case"drawBet":r="POST",o="draw/bet",a=JSON.stringify(a);break;case"drawPlayers":o="draw/getdrawplayers?drawid="+a;break;case"claimPrize":r="POST",o="draw/claimprize",a=JSON.stringify(a);break;case"getAllActivities":o="activity/getallactivities";break;case"getUserActivities":o="activity/getuseractivities";break;case"getOffers":o="offer/getoffers";break;case"trackOffer":r="POST",o="offer/trackoffer",a=JSON.stringify(a);break;case"completeOffer":r="POST",o="offer/completeoffer",a=JSON.stringify(a);break;case"cancelOffer":r="POST",o="offer/canceloffer",a=JSON.stringify(a);break;case"getUserOffers":o="offer/getuseroffers";break;case"getActions":o="rewardedaction/getactions";break;case"getUserActions":o="rewardedaction/getuseractions";break;case"trackAction":r="POST",o="rewardedaction/trackrewardedaction",a=JSON.stringify(a);break;case"getLeaderboard":o="leaderboard/gettopearners";break;case"getBadges":o="badge/getbadges";break;case"getEarnedBadges":o="badge/getearnedbadges";break;case"shareRewardAction":o="draw/getsharelinks?drawid="+a;break;case"usersGet":o="friend/getuserrelations";break;case"userFollow":r="POST",o="friend/follow",a=JSON.stringify(a);break;case"userUnfollow":r="POST",o="friend/unfollow",a=JSON.stringify(a);break;case"userRequestSend":r="POST",o="friend/sendfriendrequest",a=JSON.stringify(a);break;case"userRequestAccept":r="POST",o="friend/acceptfriendrequest",a=JSON.stringify(a);break;case"userRequestDecline":r="POST",o="friend/declinefriendrequest",a=JSON.stringify(a);break;case"userUnfriend":r="POST",o="friend/unfriend",a=JSON.stringify(a);break;case"userSearch":r="POST",o="friend/findusers",a=JSON.stringify(a);break;default:e.helpers.console.log("Api default occured")}e.global.api.rpc.apiTunnel({apiKey:e.global.api.apiKey,method:r,endpoint:o,params:a},function(t){return i=t,i.error&&401==i.status&&e.global.methods.unAuthorize(),0==i.status?void e.main.methods.notificationConstructor(["There is no Internet connection"],"error"):(n&&n(t),void e.main.methods.loadingFinished())},function(t){e.helpers.console.error(t.message),e.main.methods.loadingFinished()}),e.main.methods.loadingStarted()},e.global.api.requests.safariFix=function(){var t,n=window.open(e.global.tunnelPath+"?safarifix","_blank","menubar=no,location=no,resizable=no,scrollbars=no,status=no, width=1, height=1, top=0, left=0");t=setInterval(function(){n.closed&&(window.clearInterval(t),e.global.safariFix=!0,e.global.safariFixFirstOpen=!0,e.global.api.requests.checkServerAvailability())},50)},e.global.api.requests.checkServerAvailability=function(){e.global.api.generic("getApp",function(t){t.error&&500==t.status?e.helpers.console.error("checkServerAvailability no-server",t):(e.helpers.console.info("checkServerAvailability: ",t),t.data.IsActive?(e.global.club.name=t.data.FoundationName,e.global.api.requests.initMainFlow(),e.helpers.gaCheckPut(e.global.club.name)):e.helpers.console.warn("Widget is disabled"))})},e.global.api.requests.initMainFlow=function(){var t=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0;t&&!e.global.safariFix?e.global.api.requests.readServerCookie("safarifix",function(t){t?(e.global.safariFix=!0,e.global.api.requests.initMainFlow()):e.side.methods.changeSideWidgetState()}):"club"==e.global.type?e.global.api.requests.setServerCookie(e.global.club.name,function(t){t?e.global.methods.init():e.helpers.console.warn("no third party cookies enabled")}):"sponsor"==e.global.type?e.global.api.requests.readServerCookie(e.global.club.name,function(t){1==t&&e.global.methods.init()}):e.helpers.console.warn('Please, add "data-type" attribute to the widget')},e.global.api.requests.setServerCookie=function(t,n){e.global.api.rpc.writeClubCookie(t,function(t){e.helpers.console.info(t),n&&n(t)})},e.global.api.requests.readServerCookie=function(t,n){e.global.api.rpc.readClubCookie(t,function(t){e.helpers.console.info(t),n&&n(t)})},e.global.api.requests.connectFB=function(t,n){e.helpers.centerWindowPopup(e.global.envPath+"auth/facebook?api_key="+e.global.api.apiKey,"fbWindow",460,340,function(){e.global.api.requests.getUser(),t&&t()})},e.global.api.requests.signUp=function(t,n,a){e.global.api.generic("signUp",function(t){200==t.status?(e.helpers.console.info("signUp: ",t.data),e.global.methods.authorize(),e.main.methods.profileSetData(t.data),n&&n(t.data)):(e.helpers.console.error("signUp ",t.error),a&&a(t.error))},{Username:t.Username,Email:t.Email,Password:t.Password})},e.global.api.requests.signIn=function(t,n,a){e.global.api.generic("signIn",function(t){200==t.status?(e.helpers.console.info("signIn ",t.data),e.global.methods.authorize(),e.main.methods.profileSetData(t.data),n&&n(t.data)):(e.helpers.console.error("signIn ",t.error),a&&a(t.error))},{Email:t.Email,Password:t.Password})},e.global.api.requests.signOut=function(){e.global.api.generic("signOut",function(){e.helpers.console.info("Signed out"),e.global.methods.unAuthorize()})},e.global.api.requests.forgotPass=function(t,n,a){e.global.api.generic("forgotPass",function(t){200==t.status?(e.helpers.console.info("forgotPass ",t.data),n&&n(t.data)):(e.helpers.console.error("forgotPass ",t.error),a&&a(t.error))},{Email:t})},e.global.api.requests.getUser=function(t,n){e.global.api.generic("getUser",function(a){200==a.status?(e.helpers.console.info("getUser success ",a.data),e.global.authorized||e.global.methods.authorize(),e.main.methods.profileSetData(a.data),t&&t(a.data)):(e.global.methods.unAuthorize(),e.helpers.console.error("getUser anon ",a),n&&n(a.error))})},e.global.api.requests.getDraws=function(t,n){e.global.api.generic("getDraws",function(a){200==a.status?(e.helpers.console.info("getDraws ",a.data),e.main.cache.drawsList=a.data.Draws.sort(function(e,t){return new Date(t.EndDate)-new Date(e.EndDate)}),e.global.cache.last.winner=e.main.cache.drawsList.filter(function(e){return null!==e.Winner})[0].Winner,e.global.cache.last.prize=e.main.cache.drawsList[0].Prize,t&&t(a.data)):(e.helpers.console.error("getDraws ",a.error),n&&n(a.error))})},e.global.api.requests.getDrawEntries=function(t,n){e.global.api.generic("getDrawEntries",function(a){200==a.status?(e.helpers.console.info("getDrawEntries ",a.data),e.main.cache.drawsEntries=a.data.DrawEntries,e.main.cache.drawsEntries.some(function(e){return e.NeedToClaimPrize})&&e.side.methods.showNotification("winner"),t&&t(a.data)):(e.helpers.console.error("getDrawEntries ",a.error),n&&n(a.error))})},e.global.api.requests.drawBet=function(t,n,a,i){e.global.api.generic("drawBet",function(t){200==t.status?(e.helpers.console.info("drawBet ",t),a&&a(t.data)):(i&&i(t.error),e.helpers.console.error("drawBet ",t.error))},{DrawId:t,PointsAmount:n})},e.global.api.requests.drawPlayers=function(t,n,a){e.global.api.generic("drawPlayers",function(t){200==t.status?(e.helpers.console.info("drawPlayers ",t),n&&n(t.data)):(a&&a(t.error),e.helpers.console.error("drawPlayers ",t.error))},t)},e.global.api.requests.claimPrize=function(t,n,a,i){e.global.api.generic("claimPrize",function(t){200==t.status?a&&a(t.data):(i&&i(t.error),e.helpers.console.error(t.error))},{DrawId:t,Address1:n.Address1,Address2:n.Address2,County:n.County,Postcode:n.Postcode})},e.global.api.requests.getAllActivities=function(t,n){e.global.api.generic("getAllActivities",function(a){200==a.status?(e.helpers.console.info("getAllActivities ",a.data),t&&t(a.data)):(e.helpers.console.error("getAllActivities ",a.error),n&&n(a.error))})},e.global.api.requests.getUserActivities=function(t,n){e.global.api.generic("getUserActivities",function(a){200==a.status?(e.helpers.console.info("getUserActivities ",a.data),t&&t(a.data)):(e.helpers.console.error("getUserActivities ",a.error),n&&n(a.error))})},e.global.api.requests.getOffers=function(t,n){e.global.api.generic("getOffers",function(a){200==a.status?(e.helpers.console.info("getOffers ",a.data),t&&t(a.data)):(e.helpers.console.error("getOffers ",a.error),n&&n(a.error))})},e.global.api.requests.getUserOffers=function(t,n){e.global.api.generic("getUserOffers",function(a){200==a.status?(e.helpers.console.info("getUserOffers ",a.data),t&&t(a.data)):(e.helpers.console.error("getUserOffers ",a.error),n&&n(a.error))})},e.global.api.requests.trackOffer=function(t,n,a){e.global.api.generic("trackOffer",function(i){200==i.status?(e.helpers.console.info(i.data),e.helpers.console.info("Tracking of "+t+" has started"),n&&n(i.data)):(e.helpers.console.error("trackOffer ",i.error),a&&a(i.error))},{OfferId:t})},e.global.api.requests.completeOffer=function(t,n,a){e.global.api.generic("completeOffer",function(i){200==i.status?(e.helpers.console.info(i.data),e.helpers.console.info("Offer "+t+" has been completed"),e.global.api.requests.getUser(),e.global.api.requests.getUserOffers(),n&&n(i.data)):(e.helpers.console.error("completeOffer ",i.error),a&&a(i.error))},{OfferId:t})},e.global.api.requests.cancelOffer=function(t,n,a){e.global.api.generic("cancelOffer",function(i){200==i.status?(e.helpers.console.info(i.data),e.helpers.console.info("Offer "+t+" has been cancelled"),e.global.api.requests.getUser(),e.global.api.requests.getUserOffers(),n&&n(i.data)):(e.helpers.console.error("cancelOffer ",i.error),a&&a(i.error))},{OfferId:t})},e.global.api.requests.getActions=function(t,n){e.global.api.generic("getActions",function(a){200==a.status?(e.helpers.console.info("getActions ",a.data),e.main.cache.rewardedActions=a.data.Actions,e.main.methods.setRewardedActions(),t&&t(a.data)):(e.helpers.console.error("getActions ",a.error),n&&n(a.error))})},e.global.api.requests.getUserActions=function(t,n){e.global.api.generic("getUserActions",function(a){200==a.status?(e.helpers.console.info("getUserActions ",a.data),e.main.cache.rewardedActions=a.data.Actions,e.main.methods.setRewardedActions(),t&&t(a.data)):(e.helpers.console.error("getUserActions ",a.error),n&&n(a.error))})},e.global.api.requests.trackAction=function(t,n,a){e.global.api.generic("trackAction",function(t){200==t.status?(e.helpers.console.info("trackAction ",t.data),e.global.api.requests.getUserActions(),e.global.api.requests.getUser(),t.data.RewardResult&&n&&n(t.data)):(e.helpers.console.error("trackAction ",t.error),a&&a(t.error))},{RewardedActionTypeId:t})},e.global.api.requests.getLeaderboard=function(t,n){e.global.api.generic("getLeaderboard",function(a){200==a.status?(e.helpers.console.info("getLeaderboard ",a.data),t&&t(a.data)):(e.helpers.console.error("getLeaderboard ",a.error),n&&n(a.error))})},e.global.api.requests.getAllBadges=function(t,n){e.global.api.generic("getBadges",function(a){200==a.status?(e.helpers.console.info("getBadges ",a.data),t&&t(a.data)):(e.helpers.console.error("getBadges ",a.error),n&&n(a.error))})},e.global.api.requests.getEarnedBadges=function(t,n){e.global.api.generic("getEarnedBadges",function(a){200==a.status?(e.helpers.console.info("getEarnedBadges ",a.data),t&&t(a.data)):(e.helpers.console.error("getEarnedBadges ",a.error),n&&n(a.error))})},e.global.api.requests.shareRewardAction=function(t,n,a){e.global.api.generic("shareRewardAction",function(t){200==t.status?(e.helpers.console.info("shareRewardedAction: ",t.data),n&&n(t.data)):(e.helpers.console.error("shareRewardedAction: ",t.error),a&&a(t.error))},t)},e.global.api.requests.usersGet=function(t,n){e.global.api.generic("usersGet",function(a){200==a.status?(e.helpers.console.info("Get friends API: ",a.data),t&&t(a.data)):(e.helpers.console.error("Get friends API: ",a.error),n&&n(a.error))})},e.global.api.requests.userFollow=function(t,n,a){e.global.api.generic("userFollow",function(t){200==t.status?(e.helpers.console.info("friendFollow ",t.data),n&&n(t.data)):(e.helpers.console.error("friendFollow ",t.error),a&&a(t.error))},{UserId:t})},e.global.api.requests.userUnfollow=function(t,n,a){e.global.api.generic("userUnfollow",function(t){200==t.status?(e.helpers.console.info("friendUnfollow ",t.data),
n&&n(t.data)):(e.helpers.console.error("friendUnfollow ",t.error),a&&a(t.error))},{UserId:t})},e.global.api.requests.userRequestSend=function(t,n,a){e.global.api.generic("userRequestSend",function(t){200==t.status?(e.helpers.console.info("friendRequestSend ",t.data),n&&n(t.data)):(e.helpers.console.error("friendRequestSend ",t.error),a&&a(t.error))},{UserId:t})},e.global.api.requests.userRequestAccept=function(t,n,a){e.global.api.generic("userRequestAccept",function(t){200==t.status?(e.helpers.console.info("friendRequestAccept ",t.data),n&&n(t.data)):(e.helpers.console.error("friendRequestAccept ",t.error),a&&a(t.error))},{UserId:t})},e.global.api.requests.userRequestDecline=function(t,n,a){e.global.api.generic("userRequestDecline",function(t){200==t.status?(e.helpers.console.info("friendRequestDecline ",t.data),n&&n(t.data)):(e.helpers.console.error("friendRequestDecline ",t.error),a&&a(t.error))},{UserId:t})},e.global.api.requests.userUnfriend=function(t,n,a){e.global.api.generic("userUnfriend",function(t){200==t.status?(e.helpers.console.info("friendUnfriend ",t.data),n&&n(t.data)):(e.helpers.console.error("friendUnfriend ",t.error),a&&a(t.error))},{UserId:t})},e.global.api.requests.userSearch=function(t,n,a){e.global.api.generic("userSearch",function(t){200==t.status?(e.helpers.console.info("friendSearch ",t.data),n&&n(t.data)):(e.helpers.console.error("friendSearch ",t.error),a&&a(t.error))},{Query:t})},e.helpers.addClass=function(e,t){e&&(new RegExp(t).test(e.className)||(0===e.className.length?e.className+=t:e.className+=" "+t))},e.helpers.removeClass=function(e,t){e.className=e.className.replace(new RegExp(t),"").trim()},e.helpers.toggleClass=function(t,n){new RegExp(n).test(t.className)?e.helpers.removeClass(t,n):e.helpers.addClass(t,n)},e.helpers.hasClass=function(e,t){return new RegExp(t).test(e.className)},e.helpers.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.helpers.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},e.helpers.drawsTimerConstr=function(t){function n(e){var t="z"==e.dt.substring(e.dt.length-1).toLowerCase()?new Date(e.dt):new Date(e.dt+"Z"),n=new Date;return t-n>0}function a(){i.forEach(function(e){var t="z"==e.dt.substring(e.dt.length-1).toLowerCase()?new Date(e.dt):new Date(e.dt+"Z"),n=new Date,a=t-n,i=Math.floor(a/d),r=Math.floor(a%d/l),c=Math.floor(a%l/s),u=Math.floor(a%s/o);0>a?e.elem.innerHTML="Draw has finished":(e.elem.innerHTML=i+"d ",e.elem.innerHTML+=r+"h ",e.elem.innerHTML+=c+"m ",e.elem.innerHTML+=u+"s")})}var i,r,o=1e3,s=60*o,l=60*s,d=24*l;this.setDraws=function(t){e.helpers.isArray(t)&&(i=t.filter(function(e){return n(e)}))},this.push=function(e){return e.elem&&e.dt?n(e)?(i.push(e),!0):!1:void 0},this.start=function(){a(),r=window.setInterval(a,100)},this.stop=function(){window.clearInterval(r)},this.setDraws(t),this.start()},e.helpers.drawsTimer=new e.helpers.drawsTimerConstr([]),e.helpers.drawIsFinished=function(t){return e.helpers.dateDiff(t.EndDate)<=0},e.helpers.checkImagesForSrc=function(t){return t?t:e.global.widgetPathName+"imgs/avatar-placeholder.png"},e.helpers.imagesResponsivePaths=function(t){if(0!=arguments.length){var n=Array.prototype.slice.call(t);n.forEach(function(t){null!=t.getAttribute("data-image")&&(t.src=e.global.widgetPathName+"imgs/"+t.getAttribute("data-image"))})}},e.helpers.centerWindowPopup=function(t,n,a,i,r,o){var s,l;l=o?o:e.helpers.createCenteredWindow(n,a,i),l.location.href=t,window.focus&&l.focus(),s=window.setInterval(function(){l.closed&&(clearInterval(s),l=null,r&&r())},50)},e.helpers.createCenteredWindow=function(e,t,n){var a=void 0!=window.screenLeft?window.screenLeft:screen.left,i=void 0!=window.screenTop?window.screenTop:screen.top,r=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,s=r/2-t/2+a,l=o/2-n/2+i;return window.open("",e,"menubar=no,location=no,resizable=no,scrollbars=yes,status=no, width="+t+", height="+n+", top="+l+", left="+s)},e.helpers.getDateFromNow=function(e){function t(t,n){t="z"==t.substring(t.length-1).toLowerCase()?t:t+"Z",t=new Date(t),!n&&(n=(new Date).getTime()),n instanceof Date&&(n=n.getTime()),t instanceof Date&&(t=t.getTime());var a,i,r,o=n-t;for(i=-1,r=d.length;++i<r;)if(a=d[i],o<a[0])return a[2]==e?a[1]:Math.round(o/a[2])+" "+a[1]}var n=1e3,a=60*n,i=60*a,r=24*i,o=7*r,s=365*r,l=s/12,d=[[.7*a,"just now"],[1.5*a,"a minute ago"],[60*a,"minutes ago",a],[1.5*i,"an hour ago"],[r,"hours ago",i],[2*r,"yesterday"],[7*r,"days ago",r],[1.5*o,"a week ago"],[l,"weeks ago",o],[1.5*l,"a month ago"],[s,"months ago",l],[1.5*s,"a year ago"],[Number.MAX_VALUE,"years ago",s]];return t}(),e.helpers.dateDiff=function(e){return e="z"==e.substring(e.length-1).toLowerCase()?e:e+"Z",new Date(e)-new Date},e.helpers.getURLParameter=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),a=n.exec(t);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},e.helpers.console=function(){return{log:function(){e.global.debug&&console.log.apply(console,Array.prototype.slice.call(arguments))},info:function(){e.global.debug&&console.info.apply(console,Array.prototype.slice.call(arguments))},warn:function(){e.global.debug&&console.warn.apply(console,Array.prototype.slice.call(arguments))},error:function(){e.global.debug&&console.error.apply(console,Array.prototype.slice.call(arguments))}}}(),e.helpers.errorParser=function(t){t=JSON.parse(t);var n=[],a=[];if(!t.ModelState)return{messages:t.Message};for(var i in t.ModelState)e.helpers.isArray(t.ModelState[i])&&(t.ModelState[i].forEach(function(e){n.push(e)}),a.push(i.substr(6).toLowerCase()));return{messages:n,inputs:a}},e.helpers.insertAfter=function(e,t,n){t?t.parentNode.insertBefore(e,t.nextSibling):n&&n.appendChild(e)},e.helpers.zeroTimeout=function(e){window.setTimeout(e,0)},e.helpers.openDataLinks=function(t,n){var a=[];e.helpers.isArray(t)?a=t:a.push(t),a.forEach(function(t){var a=e.global.widgetPathName+"pages/"+t.getAttribute("data-link")+".html";t&&t.addEventListener("click",function(t){t.preventDefault(),e.helpers.showFramedSrc(a,n?n:null)})})},e.helpers.showFramedSrc=function(t,n){var a=e.main.elements.frameHolder,i=a.querySelector(".dg-o-w-iframe-holder"),r=a.querySelector(".dg-o-w-submenu"),o=a.querySelector(".dg-o-w-back-btn"),s=e.main.elements.widgetBodyWrapper;i.innerHTML="";var l=document.createElement("iframe");if(e.main.methods.loadingStarted(),l.onload=function(){e.main.methods.loadingFinished()},l.src=t,r.childNodes.length>1&&r.removeChild(r.childNodes[r.childNodes.length-1]),n&&n.nodeName){var d=document.createElement("div");d.className="right-side",d.appendChild(n),r.appendChild(d)}o.addEventListener("click",e.helpers.hideFramedSrc),e.main.methods.hideNotificationBar(),i.appendChild(l),s.appendChild(a)},e.helpers.hideFramedSrc=function(){var t=e.main.elements.frameHolder,n=e.main.elements.widgetBodyWrapper;t.parentNode==n&&(e.helpers.addClass(t,"dg-o-w-hidden"),setTimeout(function(){t.querySelector(".dg-o-w-iframe-holder").innerHTML="",e.helpers.removeClass(t,"dg-o-w-hidden"),n.removeChild(t)},300))},e.helpers.getElementsFromAllPlaces=function(t,n){if(t){var a;a="main"===n?[e.main.elements.widgetBody,e.main.elements.pages]:"side"===n?[e.side.elements.widgetBody]:[e.main.elements.widgetBody,e.side.elements.widgetBody,e.main.elements.pages];var i=[],r=[];return a.forEach(function(t){if(e.helpers.isObject(t))for(var n in t)i.push(t[n]);else i.push(t)}),i.forEach(function(e){Array.prototype.slice.call(e.querySelectorAll(t)).forEach(function(e){r.push(e)})}),r}},e.helpers.gaCheckPut=function(t){if(t=t||e.global.club.name,window.ga)if(e.global.gaSend=t+".send",ga.getByName)ga.getByName(t)?e.helpers.console.log("GA is ready, DGW is created"):ga("create",{trackingId:"UA-51923524-37",cookieDomain:"auto",name:t});else var n=window.setInterval(function(){ga.getByName&&(window.clearInterval(n),e.helpers.gaCheckPut())},50);else!function(e,t,n,a,i,r,o){e.GoogleAnalyticsObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,r=t.createElement(n),o=t.getElementsByTagName(n)[0],r.async=1,r.src=a,o.parentNode.insertBefore(r,o)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),e.helpers.gaCheckPut()},e.templates.side.profileInfo='<div class="dg-side-section"><div class="dg-side-user-img-holder"><img data-userstats-userimage class="dg-o-w-side-image-floating" src=""/></div><div class="dg-side-collapsed dg-side-floating-text"><p><span data-userstats-points-c class="dg-o-w-points-text">00</span></p><h5>Earn more</h5></div><div class="dg-side-content"><h4 data-userstats-username>Name Surname Whatever</h4><h6><span data-userstats-points-c class="dg-o-w-points-text">00</span><br/><span data-userstats-credits-c data-round="2" class="dg-o-w-credits-text">00</span></h6></div></div><div data-page="earn" class="dg-side-cta-floating"><span class="dg-side-collapsed">&rarr;</span><span class="dg-side-expanded">Earn more points</span></div>',e.templates.side.prizeGeneric='<div class="dg-side-section"><div class="dg-side-img-holder"><img data-image="everton-crest-full.png" class="dg-o-w-side-image-floating" src=""/></div><div class="dg-side-content">Sign up & get +10 points</div></div><div class="dg-side-collapsed"><div data-page="profile" class="dg-side-cta">Sign Up</div></div><div class="dg-side-expanded"><div data-page="profile" class="dg-side-cta">Sign up & get +10 points</div></div>',e.templates.sideWidgetCore='<div id="dg-side-widget-wrapper"><div class="dg-side-widget-body"><div class="dg-side-widget-content"></div><div data-page="earn" class="dg-side-click-holder"></div><div class="dg-side-notification-holder"></div></div></div>',e.templates.side.draw='<div class="dg-side-section"><img data-image="temp-green-tee.png" class="dg-side-image-bg" src=""/><div class="dg-side-content"><p>Win<br/>prizes</p><div class="dg-side-cta">Play</div></div></div><div class="dg-side-bottom-floating"><div class="dg-side-progress-bar"><div class="dg-side-progress-bar-inner"></div></div></div>',e.templates.side.anonymousSignUp='<div class="dg-side-section dg-full-size"><img data-image="temp-signup-bg.png" class="dg-side-image-bg" src=""/><div class="dg-side-content"><p>Join<br/>Everton<br/>&<br/><span class="dg-o-w-font-smaller dg-o-w-color-brand">get prizes</span></p><div class="dg-side-cta">Join</div></div></div><div class="dg-side-bottom-floating"><div class="dg-side-progress-bar"><div class="dg-side-progress-bar-inner"></div></div></div>',e.templates.side.registeredProfile='<div class="dg-side-section dg-small-size"><img data-userstats-userimage class="dg-side-image-bg" src=""/><div class="dg-side-content"><div class="dg-side-progress-bar"><div class="dg-side-progress-bar-inner"></div></div><p data-userstats-points-c class="dg-o-w-points-text">00</p></div></div>',e.templates.side.actions={earn:'<div class="dg-side-bottom-floating dg-side-action" data-page="earn">Earn</div>',play:'<div class="dg-side-bottom-floating dg-side-action" data-page="draws">Play</div>',stats:'<div class="dg-side-bottom-floating dg-side-action" data-page="profile">Stats</div>'},e.templates.side.notifications={winner:'<div class="dg-side-notification dg-side-claim-prize"></div>'},e.templates.spinner='<div class="dg-o-w-spinner"><div class="sk-circle1 sk-circle"></div><div class="sk-circle2 sk-circle"></div><div class="sk-circle3 sk-circle"></div><div class="sk-circle4 sk-circle"></div><div class="sk-circle5 sk-circle"></div><div class="sk-circle6 sk-circle"></div><div class="sk-circle7 sk-circle"></div><div class="sk-circle8 sk-circle"></div><div class="sk-circle9 sk-circle"></div><div class="sk-circle10 sk-circle"></div><div class="sk-circle11 sk-circle"></div><div class="sk-circle12 sk-circle"></div></div>',e.templates.loginFooter='<footer class="dg-o-w-footer-login"><div class="footer-section"><div class="inline-part inline-table dg-o-w-text-left"><p>Get started now and earn first <span id="dg-o-w-login-fb-reward" class="dg-o-w-rewarded-action dg-o-w-points">30</span></p><h5 class="dg-o-w-color-grey">We\'ll never send you any spam.</h5></div><div class="inline-part inline-table"><a href="#" id="dg-o-w-footer-fb-connect" class="btn-dg-o-w btn-dg-o-w-brand btn-dg-o-w-large">Connect with Facebook</a></div><div class="inline-part inline-table"><p>or</p></div><div class="inline-part inline-table"><a id="dg-o-w-footer-email-login" href="#" class="btn-dg-o-w btn-dg-o-w-brand-l btn-dg-o-w-large">Enter with email</a></div></div></footer>',e.templates.header='<div class="dg-o-w-header"><div class="dg-o-w-logo"></div><div class="dg-o-w-menu"><ul><li class="earn-menu-item">Earn</li><li class="draws-menu-item">Enter & Play</li><li class="activities-menu-item">Leaderboards</li></ul></div><div class="dg-o-w-menu-profile"><div class="profile-menu-item"><img data-userstats-userimage class="avatar" src="" /><div class="profile-menu-unauthorized"><div><h4>Hello, guest!</h4><div class="dg-o-w-login-dropdown"><a href="#" id="dg-o-w-login-trigger">Enter & get started</a><div class="dg-o-w-email-login-form"><form class="shown" id="dg-o-w-form-login-top"><h2 id="dg-o-w-login-heading">Welcome!</h2><div id="dg-o-w-header-fb-connect" class="btn-dg-o-w btn-dg-o-w-brand btn-dg-o-w-large">Connect with Facebook</div><label><input type="email" placeholder="Email" /></label><label><input type="password" placeholder="Password"/></label><label class="dg-o-w-hidden"><input type="text" placeholder="Hello, what\'s your name?"/></label><input class="btn-dg-o-w btn-dg-o-w-brand-l btn-dg-o-w-large" type="submit" value="Enter with email" /><a href="#" id="dg-o-w-header-forgot-pass" class="">Forgot your password?</a></form><form id="dg-o-w-form-forgot-top"><h2>Forgot password?</h2><div><label><input type="email" placeholder="Email" /></label><input class="btn-dg-o-w btn-dg-o-w-brand btn-dg-o-w-large" type="submit" value="Request new password" /><a href="#" class="">&larr; Back</a></div><p class="success-message">Email was sent</p></form><div class="dg-o-w-header-form-close" id="dg-o-w-header-form-close">&times;</div></div></div></div></div><div class="profile-menu-authorized"><div><h4 data-userstats-username>Hello, Paul!</h4><p><span data-userstats-points-c>25</span> | <span data-userstats-credits-c>115.25</span></p></div></div></div></div></div>',e.templates.mainWidgetCore='<div id="dg-o-w-wrapper"><div class="dg-o-w-overlay"><div class="dg-o-w-body"><div class="dg-o-w-body-wrapper">'+e.templates.header+'<div class="dg-o-w-content"><div class="dg-o-w-section"><section></section>'+e.templates.loginFooter+'</div></div></div><div class="dg-o-w-close">&times;</div>'+e.templates.spinner+'<footer class="dg-o-w-main-footer">Powered by Loyalty Rewarded, 2016 &nbsp;&nbsp;-&nbsp;&nbsp; <a data-link="faq" href="#">FAQ</a>, <a data-link="privacy" href="#">Privacy Policy</a>, <a data-link="terms" href="#">Terms & Conditions</a></footer></div></div></div>',e.templates.earnMain='<div class="dg-o-w-submenu"><ul><li class="dg-o-w-active">All</li><li>Share</li><li>Watch</li><li>Visit</li><li>Download</li><li>Invite</li></ul><select class="single-select"></select></div><div class="dg-o-w-section-content"><h3>Complete the tasks and earn +<span></span> points today</h3><ul class="dg-o-w-list-offers"></ul></div>',e.templates.drawsMain='<div class="dg-o-w-submenu"><ul><li class="dg-o-w-active" id="dg-o-w-show-all-draws">All draws</li><li id="dg-o-w-show-finished-soon">Finishing soon</li><li id="dg-o-w-show-my-draws">My draws</li><li id="dg-o-w-show-games">Games</li></ul><label class="checkbox-slider">Show completed draws <input id="dg-o-w-show-expired" type="checkbox" class="ios-switch bigswitch" /><div><div></div></div></label></div><div class="dg-o-w-section-content"><div class="dg-o-w-draws-active"><ul class="dg-o-w-list-draws"></ul></div></div>',e.templates.profileMain='<div class="dg-o-w-profile dg-o-w-white-section"><div class="dg-o-w-profile-stats"><div class="dg-o-w-image-holder"><img data-userstats-userimage class="avatar" src="" /></div><div class="dg-o-w-profile-stats-holder"><h3 data-userstats-username class="dg-o-w-profile-name">Captain Deadpool</h3><div class="dg-o-w-profile-stats-holder-rest"><div class="dg-o-w-profile-stats-inner" data-page="friends"><div><h3 class="dg-o-w-color-brand" data-friends-c></h3><p>friends</p></div><div class="dg-o-w-profile-stats-pend"><p data-friends-requests class="green-highlighter"></p></div></div><div class="dg-o-w-profile-stats-inner"><div class="dg-o-w-profile-stats-icon dg-o-w-points-icon"></div><div><h3 data-userstats-points-c>520</h3><p>points</p></div></div><div class="dg-o-w-profile-stats-inner"><div class="dg-o-w-profile-stats-icon dg-o-w-credits-icon"></div><div><h3 data-userstats-credits-c>40</h3></div></div></div></div></div><div class="dg-o-w-profile-text-block"><p id="dg-o-w-login-fb-text">Get +<span class="dg-o-w-rewarded-action" id="dg-o-w-login-fb-reward">50</span> additional points by adding your other accounts from <a href="#" class="dg-o-w-fb-connect"></a></p></div><div class="dg-o-w-profile-text-block"><p id="dg-o-w-profile-earn-today">&nbsp;</p></div><div class="dg-o-w-profile-progress"><div style="width:35%;"></div></div><div class="dg-o-w-profile-signout dg-o-w-float-right"><p class="dg-o-w-color-brand-light"><a id="dg-o-w-sign-out-btn" href="#">Sign out</a></p></div></div><div class="dg-o-w-section-content content-static dg-o-w-white-section dg-o-w-blocks-margin"><div class="dg-o-w-badges-holder"><ul></ul></div></div>',e.templates.loginMain='<div class="dg-o-w-login"><div class="dg-o-w-login-holder"><div class="dg-o-w-login-holder-content"><h1>Earn points & enter exclusive prize draws</h1><h4>Become a part of the team</h4></div></div><h4 class="dg-o-w-login-prize-title" id="dg-o-w-login-prize-title"></h4></div>',e.templates.activitiesMain='<div class="dg-o-w-submenu"><ul><li class="dg-o-w-active">Leaderboard</li></ul></div><div class="dg-o-w-section-scroller"><div class="dg-o-w-activities dg-o-w-white-section"><div class="dg-o-w-activity-slider-holder"><div class="dg-o-w-activity-slider-controls"><div class="dg-o-w-activity-slider-prev dg-o-w-arrow dg-o-w-arrow-left"></div><div class="dg-o-w-activity-slider-next dg-o-w-arrow dg-o-w-arrow-right"></div></div><div class="dg-o-w-activity-slider"><ul></ul></div></div></div><div class="dg-o-w-section-content content-static dg-o-w-white-section"><div class="dg-o-w-section-header"><p class="dg-o-w-float-left">Activities for today</p><select id="dg-o-w-activities-filter" class="dg-o-w-float-right"><option value="all-activities">All activities</option><option value="my-activities">My Activities</option></select></div><div class="dg-o-w-section-list-holder"><ul data-activities></ul></div></div></div>',e.templates.friendsMain='<div class="dg-o-w-submenu"><ul><li class="dg-o-w-active" data-submenu="friends">Friends</li><li data-submenu="following">Following</li><li data-submenu="followers">Followers</li></ul><div class="dg-o-w-float-right dg-o-w-inline-form dg-o-w-right-padding"><form class="search-form"><input class="search-field" type="text" placeholder="Search" /><span class="form-search-decorator"></span></form></div></div><div class="dg-o-w-section-scroller"><div class="dg-o-w-section-content content-static dg-o-w-white-section"><div class="dg-o-w-section-header"><div class="dg-o-w-float-right"><p class="line-height-btn">You have <span data-friends-c></span> friends <span class="green-highlighter" data-friends-requests></span></p></div></div><div class="dg-o-w-section-list-holder"><ul data-friends-list><li class="dg-o-w-table-display"><div class="dg-o-w-cell dg-o-w-cell-full"><h3>Your friends list is loading... Please, wait a bit</h3></div></li></ul></div></div></div>',e.templates.userListItem='<div class="dg-o-w-cell"><img src="" data-user-image/><div class="dg-o-w-details"><p class="dg-o-w-color-brand" data-user-name></p></div></div><div class="dg-o-w-cell"><div class="dg-o-w-users-done" data-user-common-users></div></div><div class="dg-o-w-cell" data-user-actions></div>',e.templates.userListItemNothingFound='<div class="dg-o-w-cell dg-o-w-cell-full"><h3>Unfortunately, no matching result was found.</h3></div>',e.templates.userListItemNew='<div class="dg-o-w-cell dg-o-w-cell-full"><h3>Your friends list is loading... Please, wait a bit</h3></div>',e.templates.userListActions={follow:'<div class="btn-dg-o-w btn-dg-o-w-small btn-dg-o-w-stroked" data-click-holder>Follow</div>',following:'<div class="btn-dg-o-w btn-dg-o-w-small btn-dg-o-w-stroked-okay"><span class="btn-dg-o-w-dropdown-holder">Following</span><span class="btn-dg-o-w-dropdown-action" data-click-holder>Unfollow</span></div>',followsYou:'<p class="btn-dg-o-w-text-small dg-o-w-color-grey">Follows you</p>',friends:'<div class="btn-dg-o-w btn-dg-o-w-small btn-dg-o-w-stroked-okay"><span class="btn-dg-o-w-dropdown-holder">Friends</span><span class="btn-dg-o-w-dropdown-action" data-click-holder>Unfriend</span></div>',request:'<div class="btn-dg-o-w btn-dg-o-w-small btn-dg-o-w-stroked" data-click-holder>Add to friends</div>',requestSent:'<p class="btn-dg-o-w-text-small dg-o-w-color-grey">Request sent</p>',accept:'<div class="btn-dg-o-w btn-dg-o-w-small btn-dg-o-w-stroked" data-click-holder>Accept</div>',decline:'<div class="btn-dg-o-w btn-dg-o-w-small btn-dg-o-w-stroked" data-click-holder>Decline</div>'},e.templates.videoHolderInner='<div id="dg-o-w-video-playing"></div><div class="dg-o-w-video-text"><span></span></div>',e.templates.videoHolder='<div class="dg-o-w-video-holder">'+e.templates.videoHolderInner+"</div>",e.templates.notificationHolder='<div class="dg-o-w-notification-holder"><ul></ul><div class="dg-o-w-notification-close">&times;</div></div>',e.side.elements.widget=document.createElement("div"),e.side.elements.widget.id="dg-side-widget",e.side.elements.widget.innerHTML=e.templates.sideWidgetCore,e.side.elements.widgetBody=e.side.elements.widget.querySelector(".dg-side-widget-body"),e.side.elements.widgetContent=e.side.elements.widgetBody.querySelector(".dg-side-widget-content"),e.side.elements.clickCatcher=document.createElement("div"),e.side.elements.clickCatcher.className="dg-side-click-holder",e.global.elements.documentBody=document.body,e.main.elements.widget=document.createElement("div"),e.main.elements.widget.id="dg-o-w",e.main.elements.widget.innerHTML=e.templates.mainWidgetCore,e.main.elements.widgetBody=e.main.elements.widget.querySelector(".dg-o-w-body"),e.main.elements.widgetBodyWrapper=e.main.elements.widgetBody.querySelector(".dg-o-w-body-wrapper"),e.main.elements.menuItems={earn:e.main.elements.widget.querySelector(".dg-o-w-menu .earn-menu-item"),draws:e.main.elements.widget.querySelector(".dg-o-w-menu .draws-menu-item"),activities:e.main.elements.widget.querySelector(".dg-o-w-menu .activities-menu-item"),profile:e.main.elements.widget.querySelector(".dg-o-w-menu-profile .profile-menu-item img"),profileRegistered:e.main.elements.widget.querySelector(".dg-o-w-menu-profile .profile-menu-item .profile-menu-authorized")},e.main.elements.widgetContent=e.main.elements.widget.querySelector(".dg-o-w-content .dg-o-w-section section"),e.main.elements.widgetWrapper=e.main.elements.widget.querySelector(".dg-o-w-body-wrapper"),e.main.elements.loginFooter=e.main.elements.widget.querySelector(".dg-o-w-footer-login"),e.main.elements.loginMenuButton=e.main.elements.widget.querySelector("#dg-o-w-login-trigger"),e.main.elements.pages.earnMain=document.createElement("div"),e.main.elements.pages.earnMain.innerHTML=e.templates.earnMain,e.main.elements.pages.drawsMain=document.createElement("div"),e.main.elements.pages.drawsMain.innerHTML=e.templates.drawsMain,e.main.elements.pages.singleDraw=document.createElement("div"),e.main.elements.pages.activitiesMain=document.createElement("div"),e.main.elements.pages.activitiesMain.innerHTML=e.templates.activitiesMain,e.main.elements.activitiesSliderParent=e.main.elements.pages.activitiesMain.querySelector(".dg-o-w-activities"),e.main.elements.pages.profileMain=document.createElement("div"),e.main.elements.pages.profileMain.innerHTML=e.templates.profileMain,e.main.elements.pages.loginMain=document.createElement("div"),e.main.elements.pages.loginMain.innerHTML=e.templates.loginMain,e.main.elements.pages.friendsMain=document.createElement("div"),e.main.elements.pages.friendsMain.innerHTML=e.templates.friendsMain,e.main.elements.pages.videoHolder=document.createElement("div"),e.main.elements.pages.videoHolder.innerHTML=e.templates.videoHolder,e.main.elements.pages.notificationHolder=document.createElement("div"),e.main.elements.pages.notificationHolder.innerHTML=e.templates.notificationHolder,e.main.elements.pages.notificationHolder=e.main.elements.pages.notificationHolder.querySelector("div"),e.main.elements.frameHolder=document.createElement("div"),e.main.elements.frameHolder.className="dg-o-w-frame-holder",e.main.elements.frameHolder.innerHTML='<div class="dg-o-w-submenu"><div class="dg-o-w-back-btn">&larr; Back</div></div><div class="dg-o-w-iframe-holder"></div>',e.main.methods.showWidget=function(){e.helpers.zeroTimeout(function(){e.main.shown=!0}),e.helpers.removeClass(e.main.elements.widget,"hiding"),e.global.elements.documentBody.appendChild(e.main.elements.widget),""===e.main.currentState?e.main.methods.changeMainState("earn"):e.main.methods.changeMainState(e.main.currentState),e.main.methods.pageBodyLock()},e.main.methods.hideWidget=function(){e.helpers.zeroTimeout(function(){e.main.shown=!1}),e.helpers.addClass(e.main.elements.widget,"hiding"),setTimeout(function(){e.global.elements.documentBody.removeChild(e.main.elements.widget),ga(e.global.gaSend,"pageview","Holder page")},310),e.main.methods.pageBodyUnlock()},e.main.methods.loadingStarted=function(){e.helpers.addClass(e.main.elements.widgetBody,"dg-o-w-loading")},e.main.methods.loadingFinished=function(){e.helpers.removeClass(e.main.elements.widgetBody,"dg-o-w-loading")},e.side.methods.showWidget=function(){e.global.elements.documentBody.appendChild(e.side.elements.widget),ga(e.global.gaSend,"pageview","Holder page")},e.side.methods.hideWidget=function(){e.global.elements.documentBody.removeChild(e.side.elements.widget)},e.global.methods.authorize=function(){e.main.methods.resetStates(),e.helpers.addClass(e.main.elements.widgetBody,"authorized"),e.global.authorized=!0,e.helpers.addClass(e.side.elements.widgetBody,"dg-o-w-authorized"),"draws"!==e.main.currentState&&e.main.shown&&e.main.methods.changeMainState("earn"),e.global.api.requests.getDraws(function(){e.global.api.requests.getDrawEntries(function(){e.main.methods.changeDrawsSubmenu(e.main.settings.draws.currentSubMenu)})}),e.side.methods.changeSideWidgetState(),e.global.api.requests.getUserActions()},e.global.methods.unAuthorize=function(){e.helpers.removeClass(e.main.elements.widgetBody,"authorized"),e.helpers.removeClass(e.side.elements.widgetBody,"dg-o-w-authorized"),e.global.authorized=!1,"profile"===e.main.currentState&&e.main.shown&&e.main.methods.changeMainState("profile"),e.main.methods.resetStates(),e.global.methods.userStatsReset(),e.side.methods.changeSideWidgetState(),e.side.methods.hideNotification()},e.global.methods.userStatsReset=function(){e.global.userStats.userId="",e.global.userStats.imageUrl=e.helpers.checkImagesForSrc(),e.global.userStats.name="Guest",e.global.userStats.facebookId=null,e.global.userStats.pointsC=0,e.global.userStats.pointsP=0,e.global.userStats.creditsC=0,e.global.userStats.creditsP=0,e.global.userStats.earnToday=null,e.global.userStats.badges={all:{},earned:{}},e.global.userStats.friends=0,e.global.userStats.friendsRequests=0},e.global.methods.init=function(){e.main.methods.initEvents(),e.main.elements.widgetWrapper.appendChild(e.main.elements.pages.notificationHolder),e.global.methods.userStatsReset(),e.global.api.requests.getUser(function(){},function(){e.global.api.requests.getDraws(),e.global.api.requests.getActions()}),e.global.safariFixFirstOpen&&e.main.methods.showWidget()},e.main.methods.showNotificationBar=function(t){var n=e.main.elements.pages.notificationHolder;t||(t="success"),e.helpers.addClass(n,t),n.querySelector(".dg-o-w-notification-close").addEventListener("click",e.main.methods.hideNotificationBar)},e.main.methods.hideNotificationBar=function(){e.helpers.removeClass(e.main.elements.pages.notificationHolder,"success"),e.helpers.removeClass(e.main.elements.pages.notificationHolder,"error")},e.main.methods.pageBodyLock=function(){e.helpers.addClass(e.global.elements.documentBody,"dg-o-w-body-fixed")},e.main.methods.pageBodyUnlock=function(){e.helpers.removeClass(e.global.elements.documentBody,"dg-o-w-body-fixed")},e.side.methods.ctaClick=function(){null!=this.getAttribute("data-page")&&(e.main.currentState=this.getAttribute("data-page")),e.main.shown?e.main.methods.changeMainState(e.main.currentState):e.main.methods.showWidget()},e.side.methods.initEvents=function(){e.global.launched||(e.side.methods.showWidget(),e.global.launched=!0);var t=e.side.elements.widgetBody,n=t.querySelector(".dg-side-click-holder");t.removeEventListener("click",e.global.api.requests.safariFix),n&&n.addEventListener("click",e.side.methods.ctaClick),e.helpers.imagesResponsivePaths(t.querySelectorAll("[data-image]"))},e.side.methods.initSafariFixEvents=function(){var t=e.side.elements.widgetBody;e.side.methods.showWidget(),t.addEventListener("click",e.global.api.requests.safariFix),e.helpers.imagesResponsivePaths(t.querySelectorAll("[data-image]"))},e.side.methods.changeSideWidgetState=function(t){var n,a=e.side.elements.widgetContent,i=e.side.elements.widgetBody,r=i.querySelector(".dg-side-click-holder"),o=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0;a.innerHTML="";var s=["earn","play"],l=s[Math.floor(Math.random()*s.length)];switch(t){case"draws":r.setAttribute("data-page","draws"),a.innerHTML=e.templates.side.draw;break;default:r.setAttribute("data-page","profile"),e.global.authorized?(a.innerHTML=e.templates.side.registeredProfile,a.innerHTML+=e.templates.side.actions[l]):a.innerHTML=e.templates.side.draw}n=a.querySelector("[data-page]"),n&&r.setAttribute("data-page",n.getAttribute("data-page")),o&&!e.global.safariFix?e.side.methods.initSafariFixEvents():e.side.methods.initEvents()},e.side.methods.showNotification=function(t){var n=e.side.elements.widgetBody,a=n.querySelector(".dg-side-notification-holder");a.innerHTML=e.templates.side.notifications[t]},e.side.methods.hideNotification=function(){e.side.elements.widgetBody.querySelector(".dg-side-notification-holder").innerHTML=""},e.main.methods.activitiesInit=function(){e.main.elements.pages.activitiesMain.querySelector("#dg-o-w-activities-filter").addEventListener("change",function(){"all-activities"===this.value?e.global.api.requests.getAllActivities(function(t){e.main.methods.activitiesConstructor(t.Activities)}):e.global.api.requests.getUserActivities(function(t){e.main.methods.activitiesConstructor(t.Activities)})})},e.main.methods.drawsInit=function(){e.main.elements.pages.drawsMain.querySelector("#dg-o-w-show-expired").addEventListener("change",function(t){e.main.settings.draws.showExpired=this.checked,e.main.methods.changeDrawsSubmenu(e.main.settings.draws.currentSubMenu)}),function(){function t(){r.forEach(function(t){e.helpers.removeClass(t,"dg-o-w-active")})}function n(){i.checked=!1,e.helpers.removeClass(e.main.elements.widgetBody,"draws-expired"),i.parentNode.style.display="none"}function a(){e.main.settings.draws.showExpired&&(i.checked=!0,e.helpers.addClass(e.main.elements.widgetBody,"draws-expired")),i.parentNode.style.display="block"}var i=e.main.elements.pages.drawsMain.querySelector("#dg-o-w-show-expired"),r=Array.prototype.slice.call(e.main.elements.pages.drawsMain.querySelectorAll(".dg-o-w-submenu ul li"));e.main.methods.changeDrawsSubmenu=function(e){
r.filter(function(t){return t.id==e})[0].click()},r.forEach(function(i){i.addEventListener("click",function(){switch(t(),e.helpers.addClass(this,"dg-o-w-active"),e.main.settings.draws.currentSubMenu=this.id,this.id){case"dg-o-w-show-all-draws":e.main.cache.drawsList.sort(function(e,t){return new Date(t.EndDate)-new Date(e.EndDate)}),a(),e.main.methods.drawsConstructor(e.main.cache);break;case"dg-o-w-show-finished-soon":var i=e.main.cache.drawsList.filter(function(t){return e.helpers.dateDiff(t.EndDate)<=0}),r=e.main.cache.drawsList.filter(function(t){return e.helpers.dateDiff(t.EndDate)>0}).sort(function(e,t){return new Date(e.EndDate)-new Date(t.EndDate)});e.main.cache.drawsList=r.concat(i),n(),e.main.methods.drawsConstructor(e.main.cache,"close-to-finish");break;case"dg-o-w-show-my-draws":var o=[];e.main.cache.drawsEntries.forEach(function(t){e.main.cache.drawsList.filter(function(e){e.DrawId==t.DrawId&&o.push(e)})}),e.main.cache.drawsList=e.main.cache.drawsList.sort(function(e,t){return new Date(t.EndDate)-new Date(e.EndDate)}),a(),e.main.methods.drawsConstructor({drawsList:o,drawsEntries:e.main.cache.drawsEntries},"my-draws");break;case"dg-o-w-show-games":n(),e.main.methods.gamesConstructor()}})}),e.main.methods.drawSubmenuReset=function(){t(),e.helpers.addClass(e.main.elements.pages.drawsMain.querySelector("#dg-o-w-show-all-draws"),"dg-o-w-active")}}()},function(){var t=e.main.elements.pages.friendsMain;!function(){function n(){e.main.methods.friendsResetSearch(),e.main.methods.usersConstructor(e.main.settings.friends.currentSubMenu)}var a,i=t.querySelector(".search-form .search-field"),r=t.querySelector(".search-form .form-search-decorator"),o=500;i.addEventListener("input",function(){var t=this;e.helpers.console.info("input"),t.value.length>0?(e.helpers.addClass(r,"form-search-empty"),r.addEventListener("click",n),a&&window.clearTimeout(a),a=window.setTimeout(function(){e.helpers.console.info("search"),e.helpers.addClass(r,"form-search-progress"),r.removeEventListener("click",n),e.global.api.requests.userSearch(t.value,function(t){e.main.methods.usersConstructor("search",t),e.helpers.removeClass(r,"form-search-progress"),r.addEventListener("click",n)},function(){e.helpers.removeClass(r,"form-search-progress"),r.addEventListener("click",n)})},o)):n()}),e.main.methods.friendsResetSearch=function(){i.value="",a&&window.clearTimeout(a),e.helpers.removeClass(r,"form-search-empty"),e.helpers.removeClass(r,"form-search-progress"),r.removeEventListener("click",n)}}(),function(){function n(){a.forEach(function(t){e.helpers.removeClass(t,"dg-o-w-active")})}var a=Array.prototype.slice.call(t.querySelectorAll(".dg-o-w-submenu li"));a.forEach(function(t){t.addEventListener("click",function(){n(),e.helpers.addClass(this,"dg-o-w-active"),e.main.methods.usersConstructor(this.getAttribute("data-submenu")),e.main.settings.friends.currentSubMenu=this.getAttribute("data-submenu")})})}(),e.main.methods.friendsSetData=function(t,n){var a=e.helpers.getElementsFromAllPlaces("[data-friends-c]"),i=e.helpers.getElementsFromAllPlaces("[data-friends-requests]");t||(t=e.main.cache.userRelations.users?e.main.cache.userRelations.users.filter(function(e){return e.Rels.some(function(e){return"Friends"===e})}).length:0),n||(e.main.cache.userRelations.users&&(n=e.main.cache.userRelations.users.filter(function(e){return e.Rels.some(function(e){return"FriendRequestFrom"===e})}).length),n=0),e.global.userStats.friends=t,e.global.userStats.friendsRequests=n,a.forEach(function(t){t.innerHTML=e.global.userStats.friends}),i.forEach(function(t){0===e.global.userStats.friendsRequests?t.style.display="none":t.style.display="inline-block",t.innerHTML=e.global.userStats.friendsRequests})}}(),e.main.methods.loginInit=function(){!function(){function t(){e.helpers.hasClass(a,"shown")?e.main.methods.headerLoginHide():e.main.methods.headerLoginShow()}var n=e.main.elements.loginMenuButton,a=n.parentNode,i=a.querySelector(".dg-o-w-email-login-form"),r=i.querySelector("#dg-o-w-header-form-close"),o=i.querySelector("#dg-o-w-login-heading");e.main.methods.headerLoginShow=function(t){t=t||"Welcome!",o.innerHTML=t,e.helpers.addClass(i,"visible"),setTimeout(function(){e.helpers.addClass(a,"shown"),i.querySelector("input").focus()},100)},e.main.methods.headerLoginHide=function(){e.helpers.removeClass(a,"shown"),setTimeout(function(){e.helpers.removeClass(i,"visible"),Array.prototype.slice.call(i.querySelectorAll(":not([type=submit])")).forEach(function(e){e.value=""}),e.main.methods.headerLoginReset()},310)},n.addEventListener("click",t),r.addEventListener("click",e.main.methods.headerLoginHide)}(),e.main.elements.widget.querySelector("#dg-o-w-header-fb-connect").addEventListener("click",function(t){t.preventDefault(),e.global.api.requests.connectFB()});var t=e.main.elements.widgetBody.querySelector("#dg-o-w-form-login-top"),n=e.main.elements.widgetBody.querySelector("#dg-o-w-form-forgot-top");!function(){var n=/not\sfound/,a=t.querySelector("[type=email]"),i=t.querySelector("[type=password]"),r=t.querySelector("[type=text]"),o=t.querySelector("[type=submit]"),s=o.value,l=function(s){s.preventDefault(),e.main.methods.hideNotificationBar(),e.global.api.requests.signIn({Email:a.value,Password:i.value},function(){e.main.methods.notificationConstructor(["Welcome back, "+e.global.userStats.name,"Have a look at our new offers!"]),ga(e.global.gaSend,"event","UserActions","SignIn")},function(a){var i=e.helpers.errorParser(a).messages;n.test(i)?(e.helpers.removeClass(r.parentNode,"dg-o-w-hidden"),r.focus(),t.removeEventListener("submit",l),t.addEventListener("submit",d),o.value="Sign up with email"):e.main.methods.notificationConstructor(i,"error")})},d=function(t){t.preventDefault(),e.main.methods.hideNotificationBar(),e.global.api.requests.signUp({Email:a.value,Password:i.value,Username:r.value},function(){e.main.methods.notificationConstructor(["Hi, "+r.value+"! ","Welcome to "+e.global.club.name+" rewarded widget."]),ga(e.global.gaSend,"event","UserActions","SignUp")},function(t){var n=e.helpers.errorParser(t).messages;e.main.methods.notificationConstructor(n,"error")})};t.addEventListener("submit",l),e.main.methods.headerLoginReset=function(){t.removeEventListener("submit",d),t.addEventListener("submit",l),e.helpers.addClass(r.parentNode,"dg-o-w-hidden"),o.value=s}}(),n.addEventListener("submit",function(t){t.preventDefault();var n=this,a=n.querySelector("[type=email]").value;e.global.api.requests.forgotPass(a,function(){e.main.methods.notificationConstructor("Check your email to confirm the new password."),ga(e.global.gaSend,"event","UserActions","PasswordRestoring")},function(t){e.main.methods.notificationConstructor(e.helpers.errorParser(t).messages,"error")})}),t.querySelector("#dg-o-w-header-forgot-pass").addEventListener("click",function(a){a.preventDefault(),e.helpers.removeClass(t,"shown"),e.helpers.addClass(n,"shown")}),n.querySelector("a").addEventListener("click",function(a){a.preventDefault(),e.helpers.removeClass(n,"shown"),e.helpers.addClass(t,"shown")}),e.main.elements.loginFooter.querySelector("#dg-o-w-footer-email-login").addEventListener("click",function(t){t.preventDefault(),e.main.methods.headerLoginShow()}),e.main.elements.loginFooter.querySelector("#dg-o-w-footer-fb-connect").addEventListener("click",function(t){t.preventDefault(),e.global.api.requests.connectFB()})},e.main.methods.profileInit=function(){e.main.elements.pages.profileMain.querySelector("#dg-o-w-login-fb-text").addEventListener("click",function(){e.global.api.requests.connectFB()}),e.main.elements.pages.profileMain.querySelector("#dg-o-w-sign-out-btn").addEventListener("click",function(t){t.preventDefault(),e.global.api.requests.signOut()}),e.helpers.getElementsFromAllPlaces("[data-page]","main").forEach(function(t){t.addEventListener("click",function(n){n.preventDefault(),e.main.methods.changeMainState(t.getAttribute("data-page"))})})},e.main.methods.activitiesConstructor=function(t){t.sort(function(e,t){return new Date(t.Date)-new Date(e.Date)});var n=e.helpers.getElementsFromAllPlaces("[data-activities]")[0];n.innerHTML="",t.forEach(function(t){var a=!1;t.User||(a=!0,t.User={UserName:"You",ImageUrl:e.global.userStats.imageUrl});var i=document.createElement("li"),r="";if(r+=t.User.UserName,r+=a!==!0?" has ":" have ",r+="Outflow"===t.Direction?"spent ":"earned ",r+="<span>",r+=t.PointsAmount,r+=" points",r+="</span>","GamePurchase"===t.ActivityType&&("Draw"===t.GameOrder.GameType?(r+=" playing the draw",r+=" to win "+t.GameOrder.PrizeTitle):"MatchQuiz"===t.GameOrder.GameType&&(r+=" placing a bet in "+e.global.club.name+" Score Predictor")),"RewardedActionReward"===t.ActivityType)switch(t.RewardedAction.Type){case"UserRegister":r+=" for joining our rewarded program";break;case"FacebookConnect":r+=" for connecting with Facebook";break;case"FriendSignUp":r+=" inviting a friend to our rewarding program";break;case"ConnectNewApp":r+=" connecting another app";break;case"FacebookShare":r+=" shouting out about us on Facebook";break;case"TwitterShare":r+=" tweeting about us";break;case"CommissionConfirmed":r+=" for making a great purchase";break;case"MatchQuizFacebookShare":r+=" for sharing Score Predictor results on Facebook";break;case"MatchQuizTwitterShare":r+=" for sharing Score Predictor results on Twitter"}if("OfferActionReward"===t.ActivityType)if("Share"===t.OfferAction.Type.Group.Name)switch(t.OfferAction.Type.Name){case"FacebookShare":r+=" finishing Facebook share offer";break;case"TwitterShare":r+=" finishing Twitter share offer"}else"Watch"===t.OfferAction.Type.Group.Name?r+=' watching "'+t.OfferAction.Title+'" video':"Discover"===t.OfferAction.Type.Group.Name&&(r+=" downloading an app");"BadgeReward"===t.ActivityType&&(r+=' getting a shiny new badge "'+t.BadgeReward.Title+'"'),i.innerHTML='<div class="dg-o-w-single-activity"><img src="'+e.helpers.checkImagesForSrc(t.User.ImageUrl)+'" alt=""/><div class="dg-o-w-activity-message-holder"><p>'+r+"</p></div></div><h6>"+e.helpers.getDateFromNow(t.Date)+"</h6>","Outflow"===t.Direction&&e.helpers.addClass(i,"spent"),n.appendChild(i)}),e.main.methods.setRewardedActions()},e.main.methods.gamesConstructor=function(){var t=e.main.elements.pages.drawsMain,n=t.querySelector(".dg-o-w-section-content"),a=t.querySelector(".dg-o-w-list-draws");a.innerHTML="";var i=[1];n.querySelector(".dg-o-w-draws-empty")&&n.removeChild(n.querySelector(".dg-o-w-draws-empty")),i.forEach(function(t){var n=document.createElement("li");n.innerHTML='<div class="dg-o-w-draw"><div class="dg-o-w-draw-image-holder"><img src="" data-image="temp-score-predictor-logo.png"/></div><div class="dg-o-w-draw-text"><h2 class="dg-o-w-draw-countdown">Score predictor Game</h2><p>Make predictions for your favourite matches, earn tons of points</p></div></div>',e.helpers.imagesResponsivePaths(n.querySelectorAll("img"));var i=document.createElement("a");i.href="http://everton.scorepredictor.club/",i.target="_blank",i.innerHTML="Open link in the new tab",n.setAttribute("data-link","score-predictor"),e.helpers.openDataLinks(n,i),a.appendChild(n)});var r=document.createElement("li");r.innerHTML='<div class="dg-o-w-draw"><div class="dg-o-w-draw-image-holder"><img src="" data-image="everton-bg.svg"/></div><div class="dg-o-w-draw-text"><h2 class="dg-o-w-draw-countdown">More games coming soon</h2><p></p></div></div>',r.style.opacity=.4,r.style.cursor="default",e.helpers.imagesResponsivePaths(r.querySelectorAll("img")),a.appendChild(r)},e.main.methods.drawsConstructor=function(t,n){function a(n){l=!s||n?t.drawsList.filter(function(t){return!e.helpers.drawIsFinished(t)}):t.drawsList}var i=e.main.elements.pages.drawsMain,r=i.querySelector(".dg-o-w-section-content"),o=i.querySelector(".dg-o-w-list-draws");o.innerHTML="",e.global.activeDrawsExist=!1;var s=e.main.settings.draws.showExpired,l=[],d="",c=document.createElement("div");e.helpers.addClass(c,"dg-o-w-draws-empty"),r.children.length>1&&r.removeChild(r.childNodes[1]),t&&(n&&"my-draws"!=n?a(!0):a(),0==l.length&&(n?("close-to-finish"==n&&(d="Sorry, but seems like there are no draws that will be completed soon."),"my-draws"==n&&(d="Hey, seems like you are not taking a part in any of running draws")):d="Sorry, but there are no draws running at the moment.",c.innerHTML="<h2>"+d+'</h2><br/><div class="dg-o-w-draws-refresh"></div>',c.querySelector(".dg-o-w-draws-refresh").addEventListener("click",function(){e.global.api.requests.getDraws(function(){e.global.authorized?e.global.api.requests.getDrawEntries(function(){e.main.methods.changeDrawsSubmenu(e.main.settings.draws.currentSubMenu)}):e.main.methods.changeDrawsSubmenu(e.main.settings.draws.currentSubMenu)})}),r.appendChild(c)),l.forEach(function(n){var a=document.createElement("li"),i=t.drawsEntries.filter(function(e){return e.DrawId==n.DrawId})[0]||null,r=n.Winner,s=i?i.IsWinner:!1,l="",d="",c="",u="&nbsp;",g=!1;if(i){var m=i.TicketsAmount,p=r?" dg-o-w-draw-bet-second":"";c='<div class="dg-o-w-draw-bet'+p+"\"><p>You've placed: <span>"+m+"</span> points</p></div>",i.IsWinner&&(e.helpers.addClass(a,"winner"),i.NeedToClaimPrize&&e.helpers.addClass(a,"claim-prize"))}r&&(d=s===!0?"You've won this draw!":n.Winner.UserName+" has won",l='<div class="dg-o-w-draw-list-winner"><img src="'+n.Winner.ImageUrl+'" /><p>'+d+"</p></div>"),e.helpers.drawIsFinished(n)?(e.helpers.addClass(a,"expired"),u="Finished "+e.helpers.getDateFromNow(n.EndDate)):g=!0,a.innerHTML='<div class="dg-o-w-draw"><div class="dg-o-w-draw-image-holder"><img src="'+n.Prize.ImageUrl+'" /></div><div class="dg-o-w-draw-text"><h2 class="dg-o-w-draw-countdown">'+u+"</h2><p>"+n.Prize.Description+"</p></div>"+l+c+"</div>",g&&e.helpers.drawsTimer.push({dt:n.EndDate,elem:a.querySelector(".dg-o-w-draw-countdown")}),a.addEventListener("click",function(){e.global.authorized||!g?e.main.methods.singleDrawConstructor(n.DrawId):e.main.methods.headerLoginShow("Please, enter to play the draw")}),o.appendChild(a)})),e.main.methods.setRewardedActions()},e.main.methods.singleDrawConstructor=function(t){ga(e.global.gaSend,"pageview","drawId="+t);var n=e.main.cache.drawsList.filter(function(e){return e.DrawId===t})[0],a=e.main.cache.drawsEntries.filter(function(e){return e.DrawId===t})[0],i=e.main.elements.pages.singleDraw,r='<div class="dg-o-w-draw-left-side"><div class="prize-image"><img src="'+n.Prize.ImageUrl+'" /></div></div>',o='<div class="dg-o-w-draw-share dg-o-w-draw-auth-show"><a href="#" class="dg-o-w-like dg-o-w-facebook-like">Share <span class="dg-o-w-rewarded-action" id="dg-o-w-facebook-like-reward"></span></a><a href="#" class="dg-o-w-like dg-o-w-twitter-like">Tweet <span class="dg-o-w-rewarded-action" id="dg-o-w-tweeter-like-reward"></span></a></div>',s='<div class="dg-o-w-submenu"><ul><li class="dg-o-w-back-draws">&larr; Back</li></ul><div class="right-side">'+(void 0!=a&&a.IsWinner?"You've placed "+a.TicketsAmount+" points and won!":"")+"</div></div>",l="",d=document.createElement("div");if(d.className="dg-o-w-users-done",e.main.elements.widgetContent.children.length>0&&e.main.elements.widgetContent.removeChild(e.main.elements.widgetContent.childNodes[0]),e.helpers.dateDiff(n.EndDate)<=0&&(e.helpers.console.info("isdrawn: ",n.IsDrawn),0==n.IsDrawn?(l="<p>Winner will be announced very soon!</p>",e.helpers.console.info("isdrawn: ",n.IsDrawn)):(e.helpers.console.info(n.IsDrawn),l=null==n.Winner?"<p>Unfortunately, no one has participated in this Draw</p>":'<div class="dg-o-w-draw-winner"><img src="'+(n.Winner.ImageUrl||e.helpers.checkImagesForSrc())+'" /><p>'+n.Winner.UserName+" has won this draw. Our congratulations!</p></div>")),i.innerHTML=s+'<div class="dg-o-w-section-content"><div class="dg-o-w-single-draw">'+r+'<div class="dg-o-w-draw-right-side"><h2 class="dg-o-w-countdown">&nbsp;</h2><h3>'+n.Prize.Title+"</h3><p>"+n.Prize.Description+'</p><div class="dg-o-w-draw-bet-info dg-o-w-draw-auth-show"><div class="dg-o-w-your-bet dg-o-w-points-bet"><p>You\'ve placed <span data-draw-betpoints>'+(a?a.TicketsAmount:0)+"</span> points</p></div></div>"+(e.helpers.dateDiff(n.EndDate)>0?'<h2 class="dg-o-w-draw-login-show">Please, log in to play the draw</h2>':"")+'<div class="dg-o-w-draw-bet-action dg-o-w-draw-auth-show"><h4>How much do you want to place?</h4><form id="bet-form" class="dg-o-w-one-field-form"><input type="number" min="1" max="1000" placeholder="50"/><input class="btn-dg-o-w btn-dg-o-w-brand" type="submit" value="Place points" /></form><div id="dg-o-w-get-points-btn" class="btn-dg-o-w btn-dg-o-w-brand-l">Get additional points</div></div>'+l+o+"</div></div></div>",a&&a.IsWinner){var c="";c=1==a.NeedToClaimPrize?'<p class="hide-claimed">Put your address to get the prize</p><form id="claim-prize" class="dg-o-w-form hide-claimed"><input type="text" name="Address1" placeholder="Address line 1" /><input type="text" name="Address2" placeholder="Address line 2" /><input type="text" name="County" placeholder="County" /><input type="text" name="Postcode" placeholder="Postcode" /><input class="btn-dg-o-w btn-dg-o-w-brand btn-dg-o-w-large" type="submit" value="Submit " /></form>':"<h2>You've already claimed your prize!</h2>",i.innerHTML=s+'<div class="dg-o-w-section-content"><div class="dg-o-w-single-draw">'+r+'<div class="dg-o-w-draw-right-side won"><h2>Congrats, you\'ve won!!!</h2><h3>'+n.Prize.Title+"</h3><p>"+n.Prize.Description+"</p><div>"+c+"</div>"+o+"</div></div></div>"}i.querySelector(".dg-o-w-draw-bet-info")&&e.global.api.requests.drawPlayers(t,function(e){if(e.RecentPlayers.length>0){var t=document.createElement("div");e.RecentPlayers.forEach(function(e,n){if(!(n>2)){var a=document.createElement("img");a.src=e.ImageUrl,t.appendChild(a)}}),d.appendChild(t);var n=document.createElement("p");1==e.TotalCount?n.innerHTML="1 user has done this":(n.innerHTML=e.TotalCount+" user has done this",n.className=2==e.RecentPlayers.length?"dg-o-w-two-images":"dg-o-w-three-images"),d.appendChild(n),i.querySelector(".dg-o-w-draw-bet-info").appendChild(d)}}),i.querySelector("#dg-o-w-get-points-btn")&&i.querySelector("#dg-o-w-get-points-btn").addEventListener("click",function(){e.main.methods.changeMainState("earn"),ga(e.global.gaSend,"event","DrawActions","GetAdditionalPoints")}),i.querySelector(".dg-o-w-submenu li.dg-o-w-back-draws").addEventListener("click",function(){e.main.methods.changeMainState("draws"),ga(e.global.gaSend,"event","DrawActions","BackToDrawsList")}),i.querySelector("#bet-form")&&i.querySelector("#bet-form").addEventListener("submit",function(n){n.preventDefault();var a=this,i=a.querySelector("input[type=submit]"),r=+a.querySelector("input[type=number]").value;e.global.api.requests.drawBet(t,r,function(t){i.disabled=!1,e.main.methods.notificationConstructor("We've received your "+r+" points. Bet more!"),a.querySelector("input[type=number]").value="",e.main.cache.drawsEntries.forEach(function(e){e.DrawId==t.DrawEntry.DrawId&&(e.TicketsAmount=t.DrawEntry.TicketsAmount)}),e.main.methods.changeDrawsSubmenu(e.main.settings.draws.currentSubMenu),e.main.methods.profileSetData(t.User,t.DrawEntry),ga(e.global.gaSend,"event","DrawActions","Betting","success")},function(t){i.disabled=!1,e.main.methods.notificationConstructor(e.helpers.errorParser(t).messages,"error"),ga(e.global.gaSend,"event","DrawActions","Betting","error")}),i.disabled=!0}),i.querySelector("#claim-prize")&&i.querySelector("#claim-prize").addEventListener("submit",function(n){n.preventDefault();var a=this,r={};Array.prototype.slice.call(a.querySelectorAll("input:not([type=submit])")).forEach(function(e){""==e.value&&"Address1"!=e.name&&(e.value="-"),r[e.name]=e.value}),e.global.api.requests.claimPrize(t,r,function(){e.helpers.addClass(i.querySelector(".dg-o-w-single-draw"),"claimed"),e.main.methods.notificationConstructor(["We've received your address","And will contact you very soon!"]),ga(e.global.gaSend,"event","DrawActions","ClaimPrize","AddressSent")},function(t){e.main.methods.notificationConstructor(e.helpers.errorParser(t).messages,"error")})}),e.helpers.drawsTimer.push({dt:n.EndDate,elem:i.querySelector(".dg-o-w-countdown")})||(e.helpers.addClass(i.querySelector(".dg-o-w-single-draw"),"expired"),i.querySelector(".dg-o-w-countdown")&&(i.querySelector(".dg-o-w-countdown").innerHTML="Finished "+String(e.helpers.getDateFromNow(n.EndDate))));var u=!1;a&&a.IsWinner&&(u=!0),i.querySelector(".dg-o-w-like.dg-o-w-facebook-like").addEventListener("click",function(n){n.preventDefault(),e.global.actions.requests.shareFb(t,u),ga(e.global.gaSend,"event","DrawActions","Sharing","Facebook")}),i.querySelector(".dg-o-w-like.dg-o-w-twitter-like").addEventListener("click",function(a){a.preventDefault(),e.global.actions.requests.shareTw(t,u?"I've just won "+n.Prize.Title:"Win ",u),ga(e.global.gaSend,"event","DrawActions","Sharing","Twitter")}),e.main.elements.widgetContent.appendChild(i),e.main.methods.checkSectionHeight(),e.main.methods.setRewardedActions(),i.querySelector(".dg-o-w-single-draw").style.height=i.querySelector(".dg-o-w-single-draw").clientHeight+"px"},e.main.methods.offersConstructor=function(t){function n(){return l.offers.filter(function(e){return e=e.Offer,g==d&&u==c?!0:g==d?e.Type.Group.Name.toLowerCase()==u:u==c?e.Sponsor.Name.toLowerCase()==g:e.Sponsor.Name.toLowerCase()==g&&e.Type.Group.Name.toLowerCase()==u})}function a(t){i.innerHTML="",t.forEach(function(t){var n=t.RecentCompleters,a=t.TotalCompletersCount;t=t.Offer;var r=document.createElement("li");if(r.innerHTML='<a href="" target="_blank"><div class="dg-o-w-offer"><div class="dg-o-w-offer-left"><img class="dg-o-w-offer-image" src="'+(t.ImageUrl||t.Type.ImageUrl)+'" /><p class="dg-o-w-color-green">'+t.PointsReward+'</p></div><div class="dg-o-w-offer-right"><h4><img class="dg-o-w-offer-group" src="'+t.Type.Group.ImageUrl+'"/>'+t.Title+"</h4><p>"+t.Description+'</p><div class="dg-o-w-users-done"></div></div></div></a>',"DownloadMobileApp"==t.Type.Name&&(r.querySelector("a").href=t.CustomData.Url),"DownloadToolbar"==t.Type.Name&&(r.querySelector("a").href=t.CustomData.Url.replace(/\{0}/,t.Id).replace(/\{1}/,e.global.userStats.userId)),r.querySelector("a").addEventListener("click",function(n){e.global.authorized?("DownloadMobileApp"!=t.Type.Name&&"DownloadToolbar"!=t.Type.Name&&n.preventDefault(),"FacebookShare"==t.Type.Name?e.global.offers.requests.shareOfferFb(t.Id):"TwitterShare"==t.Type.Name?e.global.offers.requests.shareOfferTw(t.Id,t.CustomData.Url,t.CustomData.TweetText,t.CustomData.Hashtags):"WatchVideo"==t.Type.Name?e.global.offers.requests.watchVideo(t.Id,t.CustomData.Url):"DownloadToolbar"==t.Type.Name&&e.global.api.requests.trackOffer(t.Id),ga(e.global.gaSend,"event","EarningPoints",t.Type.Group.Name,t.Sponsor.Name)):(n.preventDefault(),e.main.methods.headerLoginShow("Enter to earn points"),ga(e.global.gaSend,"event","EarningPointsAnonymous",t.Type.Group.Name,t.Sponsor.Name))}),n.length>0){var o=r.querySelector(".dg-o-w-users-done"),s=document.createElement("div");n.forEach(function(e,t){if(!(t>2)){var n=document.createElement("img");n.src=e.ImageUrl,s.appendChild(n)}}),o.appendChild(s);var l=document.createElement("p");1==a?l.innerHTML="1 user has done this":(l.innerHTML=a+" users have done this",l.className=2==n.length?"dg-o-w-two-images":"dg-o-w-three-images"),o.appendChild(l)}i.appendChild(r)})}var i=e.main.elements.pages.earnMain.querySelector(".dg-o-w-list-offers"),r=e.main.elements.pages.earnMain.querySelector(".dg-o-w-submenu ul"),o=e.main.elements.pages.earnMain.querySelector(".dg-o-w-submenu select"),s=e.main.elements.pages.earnMain.querySelector(".dg-o-w-section-content h3 span"),l={offers:t.Offers,sponsors:["All offers"],categories:["All"]},d=l.sponsors[0].toLowerCase(),c=l.categories[0].toLowerCase(),u=c,g=d;s.innerHTML=t.TotalPointsReward,e.global.userStats.earnToday=t.TotalPointsReward,r.innerHTML="",o.innerHTML="",l.offers.forEach(function(e){e=e.Offer,0==l.sponsors.filter(function(t){return t===e.Sponsor.Name}).length&&l.sponsors.push(e.Sponsor.Name),0==l.categories.filter(function(t){return t===e.Type.Group.Name}).length&&l.categories.push(e.Type.Group.Name)}),l.sponsors.forEach(function(e){var t=document.createElement("option");t.innerHTML=e,t.value=e.toLowerCase(),o.appendChild(t)}),l.categories.forEach(function(t,i){var o=document.createElement("li");o.innerHTML=t,o.addEventListener("click",function(){Array.prototype.slice.call(r.querySelectorAll("li")).forEach(function(t){e.helpers.removeClass(t,"dg-o-w-active")}),e.helpers.addClass(this,"dg-o-w-active"),u=t.toLowerCase(),a(n())}),"all"==t.toLowerCase()&&e.helpers.addClass(o,"dg-o-w-active"),r.appendChild(o)}),l.sponsors.length>2?o.addEventListener("change",function(){var t=this;e.helpers.console.log(t.value),g=t.value.toLowerCase(),a(n())}):o.style.display="none",a(l.offers),e.main.methods.setRewardedActions()},e.main.methods.usersConstructor=function(t,n){"use strict";function a(e,t){var n=e.User.UserName.toUpperCase(),a=t.User.UserName.toUpperCase();return a>n?-1:n>a?1:0}var i,r,o,s,l,d=e.helpers.getElementsFromAllPlaces("[data-friends-list]")[0];l=function(t){var n=document.createElement("li");return n.className="dg-o-w-table-display","empty"!==t&&t||(n.innerHTML=e.templates.userListItemNothingFound),"new"===t&&(n.innerHTML=e.templates.userListItemNew),n},s=function(t,n,a){function i(t,a){var i=e.main.cache.userRelations.users.findIndex(function(e){return e.User.UserId==n});e.main.cache.userRelations.users[i]=t,e.helpers.insertAfter(r(t),a),d.removeChild(a),e.main.methods.friendsSetData(),console.info(t.User.UserId,n)}function o(e,t,n){var a=null!=e.getAttribute("data-click-holder")?e:e.querySelector("[data-click-holder]");a.addEventListener(t,n)}var s=document.createElement("div");switch(t){case"follow":s.innerHTML=e.templates.userListActions.follow,s=s.childNodes[0],o(s,"click",function(){e.global.api.requests.userFollow(n,function(e){i(e,a)},function(t){e.helpers.console.warn("Follow ID: ",n,t.Message)})});break;case"following":s.innerHTML=e.templates.userListActions.following,s=s.childNodes[0],o(s,"click",function(){e.global.api.requests.userUnfollow(n,function(e){i(e,a)},function(t){e.helpers.console.warn("Unfollow ID: ",n,t.Message)})});break;case"followsYou":s.innerHTML=e.templates.userListActions.followsYou,s=s.childNodes[0];break;case"friends":s.innerHTML=e.templates.userListActions.friends,s=s.childNodes[0],o(s,"click",function(){e.global.api.requests.userUnfollow(n,function(e){i(e,a)},function(t){e.helpers.console.warn("Unfriend ID: ",n,t.Message)})});break;case"request":s.innerHTML=e.templates.userListActions.request,s=s.childNodes[0],o(s,"click",function(){e.global.api.requests.userRequestSend(n,function(e){i(e,a)},function(t){e.helpers.console.warn("Friend request send ID: ",n,t.Message)})});break;case"requestSent":s.innerHTML=e.templates.userListActions.requestSent,s=s.childNodes[0];break;case"accept":s.innerHTML=e.templates.userListActions.accept,s=s.childNodes[0],o(s,"click",function(){e.global.api.requests.userRequestAccept(n,function(e){i(e,a)},function(t){e.helpers.console.warn("Accept ID: ",n,t.Message)})});break;case"decline":s.innerHTML=e.templates.userListActions.decline,s=s.childNodes[0],o(s,"click",function(){e.global.api.requests.userRequestDecline(n,function(e){i(e,a)},function(t){e.helpers.console.warn("Decline ID: ",n,t.Message),console.warn(t)})});break;default:return s}return s},o=function(e,t,n){if(void 0!=e){var a=[];if(e.length>0){e=e.map(function(e){return e.toLowerCase()});var i=e.some(function(e){return"friendrequestfrom"===e}),r=e.some(function(e){return"friendrequestto"===e}),o=e.some(function(e){return"friends"===e}),l=e.some(function(e){return"following"===e}),d=e.some(function(e){return"followedby"===e});i?(a.push(s("accept",t,n)),a.push(s("decline",t,n))):r?(l?a.push(s("following",t,n)):d?a.push(s("follow",t,n)):a.push(s("follow",t,n)),a.push(s("requestSent"))):o?a.push(s("friends",t,n)):l?(a.push(s("following",t,n)),a.push(s("request",t,n))):(a.push(s("follow",t,n)),a.push(s("request",t,n)))}else a.push(s("follow",t,n)),a.push(s("request",t,n));return a}},r=function(t){var n=t.MutualFriends,a=+t.MutualFriendsTotalCount,i=t.User,r=t.Rels,s=(t.RelsCount,document.createElement("p")),l=document.createElement("li");l.className="dg-o-w-table-display",l.innerHTML=e.templates.userListItem;var d=l.querySelector("[data-user-common-users]"),c=l.querySelector("[data-user-actions]");if(l.querySelector("[data-user-image]").src=i.ImageUrl,l.querySelector("[data-user-name]").innerHTML=i.UserName,n.length>0){var u=document.createElement("div");n.forEach(function(e,t){if(!(t>2)){var n=document.createElement("img");n.src=e.ImageUrl,u.appendChild(n)}}),d.appendChild(u),1===a?s.innerHTML="1 common user":(s.innerHTML=a+" common users",s.className=2==n.length?"dg-o-w-two-images":"dg-o-w-three-images")}else s.innerHTML="No common users";return d.appendChild(s),o(r,i.UserId,l).forEach(function(e){c.appendChild(e)}),l},d.innerHTML="","friends"===t?(i=e.main.cache.userRelations.users.filter(function(e){return e.Rels.some(function(e){return"FriendRequestFrom"===e||"Friends"===e||"FriendRequestTo"===e})}),i=i.filter(function(e){return e.Rels.some(function(e){return"FriendRequestFrom"===e})}).sort(a).concat(i.filter(function(e){return e.Rels.some(function(e){return"Friends"===e})}).sort(a).concat(i.filter(function(e){return e.Rels.some(function(e){return"FriendRequestTo"===e})}).sort(a)))):"following"===t?(i=e.main.cache.userRelations.users.filter(function(e){return e.Rels.some(function(e){return"Following"===e})}),i=i.filter(function(e){return e.Rels.some(function(e){return"Following"===e})}).sort(a)):"followers"===t?(i=e.main.cache.userRelations.users.filter(function(e){return e.Rels.some(function(e){return"FollowedBy"===e})}),i=i.filter(function(e){return e.Rels.some(function(e){return"Following"===e})}).sort(a).concat(i.filter(function(e){return e.Rels.some(function(e){return"FollowedBy"===e})&&e.Rels.every(function(e){return"Following"!==e})}).sort(a))):"search"===t&&(i=n.Users,i=i.filter(function(e){return e.Rels.some(function(e){return"FriendRequestFrom"===e})}).sort(a).concat(i.filter(function(e){return e.Rels.some(function(e){return"Friends"===e})}).sort(a).concat(i.filter(function(e){return e.Rels.some(function(e){return"FriendRequestTo"===e})}).sort(a))).concat(i.filter(function(e){return e.Rels.some(function(e){return"Following"===e})}).sort(a).concat(i.filter(function(e){return e.Rels.some(function(e){return"FollowedBy"===e})&&e.Rels.every(function(e){return"Following"!==e})}).sort(a))).concat(i.filter(function(e){return 0===e.Rels.length}).sort(a))),i.length>0?i.forEach(function(e){d.appendChild(r(e))}):d.appendChild(l()),e.main.methods.friendsSetData(),e.helpers.console.info("Number of relations > 1: ",e.main.cache.userRelations.users.filter(function(e){return e.Rels.length>1}).length)},e.main.methods.leaderboardConstructor=function(t){function n(e){"right"===e?c<+i.style.width.replace(/px/,"")-5*s&&(c+=s):c>0&&(c-=s),i.style.transform="translateX(-"+c+"px)"}var a=e.main.elements.pages.activitiesMain,i=a.querySelector(".dg-o-w-activity-slider ul"),r=a.querySelector(".dg-o-w-activity-slider-prev"),o=a.querySelector(".dg-o-w-activity-slider-next"),s=0,l=/translateX\(-(\d*)px\)/,d=i.style.transform,c=d?+l.exec(d)[1]:0;i.innerHTML="",i.style.width="",t.forEach(function(e){var t=document.createElement("li");t.innerHTML='<div><img src="'+e.ImageUrl+'"><p>'+e.Amount+'</p></div><p class="dg-o-w-color-brand">'+e.UserName+"</p>",i.appendChild(t),i.style.width=+i.style.width.replace(/px/,"")+t.clientWidth+"px"}),s=i.querySelector("li").clientWidth,r.addEventListener("click",function(){n()}),o.addEventListener("click",function(){n("right")})},e.main.methods.profileSetData=function(t,n){var a=e.main.elements.pages.profileMain,i=(e.main.elements.widgetBody,e.side.elements.widgetBody,e.helpers.getElementsFromAllPlaces("[data-userstats-userimage]")),r=e.helpers.getElementsFromAllPlaces("[data-userstats-username]"),o={confirmed:e.helpers.getElementsFromAllPlaces("[data-userstats-points-c]"),
pending:[a.querySelector(".dg-o-w-profile-points h5")]},s={confirmed:e.helpers.getElementsFromAllPlaces("[data-userstats-credits-c]"),pending:[a.querySelector(".dg-o-w-profile-credits h5")]},l=a.querySelector("#dg-o-w-login-fb-text");if(e.global.userStats.userId=t.UserId,i.forEach(function(n){n&&(n.src=t.ImageUrl||e.helpers.checkImagesForSrc(n.getAttribute("src")))}),e.global.userStats.imageUrl=t.ImageUrl||e.global.userStats.imageUrl,r.forEach(function(e){e&&(e.innerHTML=t.UserName)}),e.global.userStats.name=t.UserName||e.global.userStats.name,e.global.userStats.facebookId=t.FacebookId,o.confirmed.forEach(function(e){e&&(e.innerHTML=t.Wallet.PointsConfirmed)}),o.pending.forEach(function(e){e&&(e.innerHTML=t.Wallet.PointsPending)}),s.confirmed.forEach(function(e){e&&(e.getAttribute("data-round")?e.innerHTML=t.Wallet.CreditsConfirmed.toFixed(e.getAttribute("data-round")):e.innerHTML=t.Wallet.CreditsConfirmed)}),s.pending.forEach(function(e){e&&(e.innerHTML=t.Wallet.CreditsPending)}),e.global.userStats.pointsC=t.Wallet.PointsConfirmed,e.global.userStats.pointsP=t.Wallet.PointsPending,e.global.userStats.creditsC=t.Wallet.CreditsConfirmed,e.global.userStats.creditsP=t.Wallet.CreditsPending,e.main.methods.friendsSetData(t.FriendsCount,t.FriendRequestsCount),l&&(null!==e.global.userStats.facebookId?l.style.display="none":l.style.display="block"),e.global.userStats.earnToday&&a.querySelector("#dg-o-w-profile-earn-today")&&(a.querySelector("#dg-o-w-profile-earn-today").innerHTML='You can <span class="dg-o-w-color-brand">earn +'+e.global.userStats.earnToday+" points</span> more"),n){var d=e.main.elements.pages.singleDraw.querySelector("[data-draw-betpoints]");d&&(d.innerHTML=n.TicketsAmount||0)}},e.main.methods.updateBadgesInfo=function(){function t(t,n){function i(){m.forEach(function(t){e.helpers.removeClass(t,"dg-o-w-active")})}function o(t){var n=m.indexOf(m.filter(function(t,n){return e.helpers.hasClass(t,"dg-o-w-active")})[0]);i(),"left"===t?n>0?e.helpers.addClass(m[n-1],"dg-o-w-active"):e.helpers.addClass(m[m.length-1],"dg-o-w-active"):n<m.length-1?e.helpers.addClass(m[n+1],"dg-o-w-active"):e.helpers.addClass(m[0],"dg-o-w-active")}var s='<div class="dg-o-w-submenu"><ul><li class="dg-o-w-back-draws">&larr; Back</li></ul></div>',l='<div class="dg-o-w-badge-single dg-o-w-white-section"><ul></ul><div class="dg-o-w-badge-single-left dg-o-w-arrow dg-o-w-arrow-left"></div><div class="dg-o-w-badge-single-right dg-o-w-arrow dg-o-w-arrow-right"></div></div>',d=document.createElement("div");d.className="dg-o-w-badge-single-page",d.innerHTML=s+l;var c=d.querySelector(".dg-o-w-badge-single ul"),u=d.querySelector(".dg-o-w-badge-single-left"),g=d.querySelector(".dg-o-w-badge-single-right"),m=[];t.forEach(function(t){var i=document.createElement("li");i.innerHTML='<div><img src="'+t.ImageUrl+'" /><h3>'+t.Title+"</h3><p>"+t.Description+"</p></div>",t.BadgeId===n&&(i.className="dg-o-w-active"),a.filter(function(e){return e.BadgeId==t.BadgeId}).length>0&&e.helpers.addClass(i,"dg-o-w-earned"),m.push(i),c.appendChild(i)}),d.querySelector(".dg-o-w-submenu li").addEventListener("click",function(){r.removeChild(d)}),u.addEventListener("click",function(){o("left")}),g.addEventListener("click",function(){o("right")}),r.appendChild(d)}var n=e.global.userStats.badges.all,a=e.global.userStats.badges.earned,i=e.main.elements.pages.profileMain,r=e.main.elements.widgetContent,o=i.querySelector(".dg-o-w-badges-holder ul");o.innerHTML="",n.forEach(function(i){var r=document.createElement("li");r.innerHTML='<img src="'+i.ImageUrl+'" alt=""/><p class="dg-o-w-color-brand">'+i.Title+"</p>",a.filter(function(e){return e.BadgeId==i.BadgeId}).length>0&&e.helpers.addClass(r,"dg-o-w-earned"),r.addEventListener("click",function(){t(n,i.BadgeId)}),o.appendChild(r)})},e.main.methods.checkSectionHeight=function(){var t=e.main.elements.widgetBody.querySelector(".dg-o-w-section"),n=e.main.elements.widgetBody.querySelector(".dg-o-w-section-content");t.querySelector(".dg-o-w-submenu")&&(e.helpers.addClass(n,"dg-o-w-submenu-only"),e.helpers.removeClass(n,"dg-o-w-submenu-activities"),t.querySelector(".dg-o-w-activity-slider-holder")&&!e.helpers.hasClass(t.querySelector(".dg-o-w-activities"),"collapsed")&&(e.helpers.addClass(n,"dg-o-w-submenu-activities"),e.helpers.removeClass(n,"dg-o-w-submenu-only")))},e.main.methods.changeMainState=function(t){e.global.authorized||"profile"!==t?ga(e.global.gaSend,"pageview",t):ga(e.global.gaSend,"pageview","landing");for(var n in e.main.elements.menuItems)e.helpers.removeClass(e.main.elements.menuItems[n],"dg-o-w-active");switch(e.helpers.removeClass(e.main.elements.menuItems.profile.parentNode.parentNode,"dg-o-w-active"),"profile"===t?e.helpers.addClass(e.main.elements.menuItems.profile.parentNode.parentNode,"dg-o-w-active"):e.helpers.addClass(e.main.elements.menuItems[t],"dg-o-w-active"),e.main.elements.widgetContent.children.length>0&&Array.prototype.slice.call(e.main.elements.widgetContent.children).forEach(function(t){e.main.elements.widgetContent.removeChild(t)}),"draws"!==e.main.currentState&&e.helpers.drawsTimer.setDraws([]),e.helpers.removeClass(e.main.elements.widgetBody,"profile-anon"),t){case"earn":e.global.authorized?e.global.api.requests.getUserOffers(function(t){e.main.methods.offersConstructor(t),e.global.userStats.earnToday=t.TotalPointsReward}):e.global.api.requests.getOffers(function(t){e.main.methods.offersConstructor(t)}),e.main.elements.widgetContent.appendChild(e.main.elements.pages.earnMain);break;case"draws":"draws"!==e.main.currentState&&(e.global.api.requests.getDraws(function(){e.global.authorized?e.global.api.requests.getDrawEntries(function(){e.main.methods.changeDrawsSubmenu(e.main.settings.draws.currentSubMenu)}):e.main.methods.changeDrawsSubmenu(e.main.settings.draws.currentSubMenu)}),e.main.methods.drawSubmenuReset()),e.main.elements.widgetContent.appendChild(e.main.elements.pages.drawsMain);break;case"activities":"all-activities"===e.main.elements.pages.activitiesMain.querySelector("#dg-o-w-activities-filter").value?e.global.api.requests.getAllActivities(function(t){e.main.methods.activitiesConstructor(t.Activities)}):e.global.api.requests.getUserActivities(function(t){e.main.methods.activitiesConstructor(t.Activities)}),e.global.api.requests.getLeaderboard(function(t){e.main.methods.leaderboardConstructor(t.Earners)}),e.main.elements.widgetContent.appendChild(e.main.elements.pages.activitiesMain);break;case"profile":e.global.authorized?(e.main.elements.widgetContent.appendChild(e.main.elements.pages.profileMain),e.global.api.requests.getUser(),e.global.api.requests.getAllBadges(function(t){e.global.userStats.badges.all=t.Badges,e.global.api.requests.getEarnedBadges(function(t){e.global.userStats.badges.earned=t.EarnedBadges,e.main.methods.updateBadgesInfo()})})):(e.helpers.addClass(e.main.elements.widgetBody,"profile-anon"),e.main.elements.widgetContent.appendChild(e.main.elements.pages.loginMain));break;case"friends":e.main.elements.widgetContent.appendChild(e.main.elements.pages.friendsMain),e.global.api.requests.usersGet(function(t){e.main.cache.userRelations.users=t.Users,e.main.cache.userRelations.count=t.UsersCount,e.main.methods.friendsResetSearch(),e.main.methods.usersConstructor(e.main.settings.friends.currentSubMenu)})}e.helpers.hideFramedSrc(),e.main.methods.hideNotificationBar(),e.main.currentState=t,e.main.methods.setRewardedActions(),e.main.methods.checkSectionHeight()},e.main.methods.initEvents=function(){e.main.methods.fillDefaultValues(),e.main.elements.widget.querySelector(".dg-o-w-close").addEventListener("click",e.main.methods.hideWidget);for(var t in e.main.elements.menuItems)e.main.elements.menuItems[t].addEventListener("click",function(t){return function(){"profileRegistered"==t&&(t="profile"),e.main.methods.changeMainState(t)}}(t));e.main.methods.loginInit(),e.main.methods.activitiesInit(),e.main.methods.drawsInit(),e.main.methods.profileInit(),e.helpers.openDataLinks(Array.prototype.slice.call(e.main.elements.widgetBody.querySelectorAll("[data-link]")))},e.main.methods.resetStates=function(){e.main.elements.widgetBody.querySelector(".dg-o-w-menu-profile .profile-menu-item img").src=e.helpers.checkImagesForSrc(),e.main.elements.pages.activitiesMain.querySelector("#dg-o-w-activities-filter").value="all-activities",e.helpers.removeClass(e.main.elements.loginFooter,"email-sign-up"),e.helpers.removeClass(e.main.elements.loginFooter,"password"),e.main.methods.headerLoginHide(),e.main.methods.fillDefaultValues(),e.main.cache.drawsEntries=[]},e.main.methods.fillDefaultValues=function(){var t=e.main.elements.pages.drawsMain.querySelector("#dg-o-w-show-expired"),n=setInterval(function(){if(e.global.cache.last.prize){var t=e.main.elements.pages.loginMain.querySelector("#dg-o-w-login-prize-title");t&&(t.innerHTML="Today you can win "+e.global.cache.last.prize.Title),clearInterval(n)}},50);e.main.settings.draws.showExpired?(t.checked=!0,e.helpers.addClass(e.main.elements.widgetBody,"draws-expired")):(t.checked=!1,e.helpers.removeClass(e.main.elements.widgetBody,"draws-expired"))},e.main.methods.setRewardedActions=function(t,n){t||(t=e.main.elements.widget),n||(n=e.main.cache.rewardedActions),t.querySelector(".dg-o-w-rewarded-action")&&n.length>0&&(t.querySelector("#dg-o-w-login-fb-reward")&&n.filter(function(e){return"FacebookConnect"==e.Type}).length>0&&(t.querySelector("#dg-o-w-login-fb-reward").innerHTML=n.filter(function(e){return"FacebookConnect"==e.Type})[0].PointsReward),t.querySelector("#dg-o-w-friends-sign-up-reward")&&n.filter(function(e){return"FriendSignUp"==e.Type}).length>0&&(t.querySelector("#dg-o-w-friends-sign-up-reward").innerHTML=n.filter(function(e){return"FriendSignUp"==e.Type})[0].PointsReward),t.querySelector("#dg-o-w-facebook-like-reward")&&(n.filter(function(e){return"FacebookShare"==e.Type}).length>0?t.querySelector("#dg-o-w-facebook-like-reward").innerHTML=" and get +"+n.filter(function(e){return"FacebookShare"==e.Type})[0].PointsReward+" points":t.querySelector("#dg-o-w-facebook-like-reward").innerHTML=""),t.querySelector("#dg-o-w-tweeter-like-reward")&&(n.filter(function(e){return"TwitterShare"==e.Type}).length>0?t.querySelector("#dg-o-w-tweeter-like-reward").innerHTML=" and get +"+n.filter(function(e){return"TwitterShare"==e.Type})[0].PointsReward+" points":t.querySelector("#dg-o-w-tweeter-like-reward").innerHTML=""))},e.main.methods.notificationConstructor=function(t,n){var a=e.main.elements.pages.notificationHolder.querySelector("ul");if(a.innerHTML="",n||(n="success"),e.helpers.isArray(t))t.forEach(function(e){var t=document.createElement("li");t.innerHTML=e,a.appendChild(t)}),e.main.methods.showNotificationBar(n);else if("string"==typeof t){var i=document.createElement("li");i.innerHTML=t,a.appendChild(i),e.main.methods.showNotificationBar(n)}else e.helpers.console.warn("Notification parameters are not of the type of [Array] or String")},e.global.offers.requests.shareOfferFb=function(t){e.helpers.centerWindowPopup(e.global.envPath+"offer/facebookshare?api_key="+e.global.api.apiKey+"&offerid="+t,"fbWindow",460,340,function(){e.global.api.requests.getUserOffers(function(t){e.main.methods.offersConstructor(t),e.global.userStats.earnToday=t.TotalPointsReward})})},e.global.offers.requests.shareOfferTw=function(t,n,a,i){e.global.api.requests.trackOffer(t),e.helpers.centerWindowPopup("https://twitter.com/intent/tweet?text="+a+"&url="+encodeURIComponent(n)+"&hashtags="+i,"twWindow",460,340,function(){e.global.api.requests.completeOffer(t,function(){e.global.api.requests.getUserOffers(function(t){e.main.methods.offersConstructor(t),e.global.userStats.earnToday=t.TotalPointsReward}),e.main.methods.notificationConstructor("Cool, you've just earned more points for Sharing on Twitter")})})},e.global.actions.requests.shareFb=function(t,n){var a=e.helpers.createCenteredWindow("shareFbAction",460,340);e.global.api.requests.shareRewardAction(t,function(t){e.helpers.centerWindowPopup(e.global.envPath+"rewardedaction/facebookshare?api_key="+e.global.api.apiKey+"&shareurl="+encodeURIComponent(n?t.WinnerShareUrl:t.ShareUrl),"fbWindow2",460,340,function(){e.global.api.requests.getUser(),e.global.api.requests.getUserActions()},a)})},e.global.actions.requests.shareTw=function(t,n,a){var i=e.helpers.createCenteredWindow("shareTwAction",460,340);e.global.api.requests.shareRewardAction(t,function(t){e.helpers.centerWindowPopup("https://twitter.com/intent/tweet?text="+n+"&url="+encodeURIComponent(a?t.WinnerShareUrl:t.ShareUrl)+"&hashtags="+e.global.club.name,"twWindow2",460,340,function(){e.global.api.requests.trackAction(5,function(){e.main.methods.notificationConstructor("Cool, you've just earned more points for Sharing on Twitter")})},i)})},e.global.offers.requests.watchVideo=function(t,n){function a(){c=new YT.Player("dg-o-w-video-playing",{height:e.main.elements.widgetBody.clientHeight,width:e.main.elements.widgetBody.clientWidth,videoId:e.helpers.getURLParameter("v",n),playerVars:{controls:0,rel:0,origin:window.document.origin,fs:0,modestbranding:1},events:{onReady:r,onStateChange:o}})}function i(t){c.destroy(),e.main.elements.pages.videoHolder.querySelector(".dg-o-w-video-holder").innerHTML=e.templates.videoHolderInner,t&&setTimeout(t,10)}function r(n){n.target.playVideo(),e.global.api.requests.trackOffer(t),g=window.setInterval(function(){0==e.main.shown&&s()},100),e.helpers.console.info("Video duration available: ",!!c.getDuration),2>=p&&(c.getDuration?(m=window.setInterval(function(){e.main.elements.pages.videoHolder.querySelector("span").innerHTML=Math.floor(c.getDuration()-c.getCurrentTime())},1e3),e.helpers.console.log("Video has started")):(i(a),p+=1,e.helpers.console.info("No duration")))}function o(n){0===n.data&&(l(),e.global.api.requests.completeOffer(t,function(){e.main.methods.notificationConstructor("Cool, you've just earned more points for Watching this cool video")}),e.helpers.console.log("Video has finished"))}function s(){e.global.api.requests.cancelOffer(t),l()}function l(){e.helpers.addClass(e.main.elements.pages.videoHolder.querySelector(".dg-o-w-video-holder"),"dg-video-hidden"),setTimeout(function(){e.main.elements.pages.videoHolder.parentNode&&e.main.elements.widgetBody.removeChild(e.main.elements.pages.videoHolder),e.helpers.removeClass(e.main.elements.pages.videoHolder.querySelector(".dg-o-w-video-holder"),"dg-video-hidden"),i(),f.removeEventListener("click",s),f.addEventListener("click",e.main.methods.hideWidget)},320),e.main.elements.pages.videoHolder.querySelector("span").innerHTML="",window.clearInterval(g),window.clearInterval(m)}function d(){u=window.setInterval(function(){window.YT.Player&&(window.clearInterval(u),e.main.elements.widgetBody.appendChild(e.main.elements.pages.videoHolder),f.removeEventListener("click",e.main.methods.hideWidget),f.addEventListener("click",s),window.setTimeout(function(){a()},0))},50)}var c,u,g,m,p=0,f=e.main.elements.widget.querySelector(".dg-o-w-close");if(window.YT)d();else{var h=document.createElement("script");h.onload=function(){d()},h.src="https://www.youtube.com/player_api",document.head.appendChild(h)}},e.global.offers.requests.openExternalLink=function(t){e.helpers.showFramedSrc(t)};var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.addEventListener("load",function(){e.global.api.requests.checkServerAvailability()}),t.href=e.global.widgetPathName+"style.min.css";var n=document.head.getElementsByTagName("link")[document.head.getElementsByTagName("link").length-1];window.innerWidth>1024?e.helpers.insertAfter(t,n,document.head):e.helpers.console.info("Widget: Mobile screen size, no widget allowed"),e.global.debug&&(window.DGW=e),window.dgwActivateDebugMode=function(){e.global.debug=!0}}});
